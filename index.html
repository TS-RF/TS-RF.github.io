<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://ts-rf.github.io/" hreflang="en" rel="alternate"/>
  <link href="https://ts-rf.github.io/zh/" hreflang="zh-CN" rel="alternate"/>
  <link href="https://ts-rf.github.io/" hreflang="x-default" rel="alternate"/>
  <meta content="TSRF: Interpretable Fault Diagnosis for Marine Diesel Engines" property="og:title"/>
  <meta content="Proposing a Physics-Informed Machine Learning (PIML) and Explainable AI approach for marine engine health management, combining thermodynamic simulation with the Random Forest algorithm." property="og:description"/>
  <meta content="https://ts-rf.github.io/static/images/fig1_structure.jpg" property="og:image"/>
  <meta content="https://ts-rf.github.io/" property="og:url"/>
  <meta content="website" property="og:type"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta charset="utf-8"/>
  <meta content="Proposing a Physics-Informed Machine Learning (PIML) and Explainable AI approach for marine engine health management, combining thermodynamic simulation with the Random Forest algorithm." name="description"/>
  <meta content="Marine Diesel Engine, Fault Diagnosis, Random Forest, SHAP, Explainable AI, Physics-Informed Machine Learning, PIML, Mechanistic Model, Synthetic Data Generation, Predictive Maintenance, Thermodynamic Simulation, AVL BOOST" name="keywords"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
    TSRF: Interpretable Fault Diagnosis for Marine Diesel Engines
  </title>
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL">
  </script>
  <script>
    window.dataLayer = window.dataLayer || [];
     function gtag() { dataLayer.push(arguments); }
     gtag('js', new Date());
     gtag('config', 'G-PYVRSFMDRL');
  </script>
  <script>
    window.MathJax = {
       tex: {
         inlineMath: [['$', '$'], ['\\(', '\\)']]
       }
     };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet"/>
  <link href="../static/css/bulma.min.css" rel="stylesheet"/>
  <link href="../static/css/bulma-carousel.min.css" rel="stylesheet"/>
  <link href="../static/css/bulma-slider.min.css" rel="stylesheet"/>
  <link href="../static/css/fontawesome.all.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" rel="stylesheet"/>
  <link href="../static/css/index.css" rel="stylesheet"/>
  <link href="../static/images/favicon.svg" rel="icon"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
  </script>
  <script defer="" src="../static/js/fontawesome.all.min.js">
  </script>
  <script src="../static/js/bulma-carousel.min.js">
  </script>
  <script src="../static/js/bulma-slider.min.js">
  </script>
  <script src="../static/js/index.js">
  </script>
  <style>
    .keyword-label {
       font-weight: bold;
       margin-right: 10px;
       vertical-align: middle;
       color: #363636;
     }
 
     .tags .tag {
       transition: all 0.2s ease;
       font-size: 0.9rem;
     }
 
     .tags .tag:hover {
       background-color: #3273dc;
       color: #fff;
       transform: translateY(-2px);
       box-shadow: 0 4px 6px rgba(50, 115, 220, 0.2);
     }
 
     /* Ê†∏ÂøÉÂä®ÁîªÁ±ª */
     .reveal {
       opacity: 0;
       transform: translateY(30px);
       transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
     }
 
     .reveal.active {
       opacity: 1;
       transform: translateY(0);
     }
 
     /* ÁÆÄÂçïÁöÑÂª∂ËøüÁ±ª */
     .reveal.delay-1 { transition-delay: 0.1s; }
     .reveal.delay-2 { transition-delay: 0.2s; }
     .reveal.delay-3 { transition-delay: 0.3s; }
 
     .hover-card {
       transition: transform 0.3s ease, box-shadow 0.3s ease;
       will-change: transform;
     }
 
     .hover-card:hover {
       transform: translateY(-5px);
       box-shadow: 0 10px 30px -10px rgba(0,0,0,0.2);
     }
 
     .highlight-list li {
       background: #f8f9fa;
       padding: 1.5rem;
       border-radius: 8px;
       margin-bottom: 1rem;
       border-left: 4px solid #3273dc;
     }
 
     .stagger-wrapper .stagger-item {
       opacity: 0;
       transform: translateX(-20px);
       transition: all 0.6s ease-out;
     }
 
     .stagger-wrapper.active .stagger-item {
       opacity: 1;
       transform: translateX(0);
     }
 
     .stagger-wrapper.active .stagger-item:nth-child(1) { transition-delay: 0.1s; }
     .stagger-wrapper.active .stagger-item:nth-child(2) { transition-delay: 0.3s; }
     .stagger-wrapper.active .stagger-item:nth-child(3) { transition-delay: 0.5s; }
  </style>
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ScholarlyArticle",
      "headline": "Thermodynamic Simulation-Assisted Random Forest: Interpretable Fault Diagnosis for Marine Diesel Engine Combustion Chamber Components",
      "image": [
        "https://ts-rf.github.io/static/images/fig1_structure.jpg"
      ],
      "datePublished": "2025-01-01",
      "author": [
        {
          "@type": "Person",
          "name": "Congcong Luo"
        },
        {
          "@type": "Person",
          "name": "Minghang Zhao"
        },
        {
          "@type": "Person",
          "name": "Xuyun Fu"
        }
      ],
      "publisher": {
        "@type": "Organization",
        "name": "Elsevier Measurement"
      },
      "description": "A Physics-Informed Machine Learning approach combining thermodynamic simulation and SHAP for marine diesel engine fault diagnosis."
    }
  </script>
</head>
<body>
  <nav aria-label="main navigation" class="navbar" role="navigation">
    <div class="navbar-brand">
      <a aria-expanded="false" aria-label="menu" class="navbar-burger" role="button">
     <span aria-hidden="true">
     </span>
        <span aria-hidden="true">
     </span>
        <span aria-hidden="true">
     </span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start">
      </div>
      <a class="navbar-item navbar-absolute-center" href="https://scholar.google.com/citations?hl=zh-CN&amp;user=k82TzLwAAAAJ" target="_blank">
     <span class="icon" style="margin-right: 0.3rem;">
      <img alt="Google Scholar" src="https://upload.wikimedia.org/wikipedia/commons/c/c7/Google_Scholar_logo.svg" style="height: 20px; width: 20px;"/>
     </span>
        <span>
      Minghang Zhao (Google Scholar)
     </span>
      </a>
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
       <span class="icon">
        <i class="fas fa-globe">
        </i>
       </span>
            <span>
        Languages
       </span>
          </a>
          <div class="navbar-dropdown is-right" style="max-height: 500px; overflow-y: auto;">
            <a class="navbar-item" href="https://ts-rf.github.io/">
              English
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/zh-CN/">
              ÁÆÄ‰Ωì‰∏≠Êñá
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/zh-TW/">
              ÁπÅÈ´î‰∏≠Êñá
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/hi/">
              ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/es/">
              Espa√±ol
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/fr/">
              Fran√ßais
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/ar/">
              ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/pt/">
              Portugu√™s
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/ru/">
              –†—É—Å—Å–∫–∏–π
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/id/">
              Indonesia
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/de/">
              Deutsch
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/ja/">
              Êó•Êú¨Ë™û
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/tr/">
              T√ºrk√ße
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/vi/">
              Ti·∫øng Vi·ªát
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/ko/">
              ÌïúÍµ≠Ïñ¥
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/fa/">
              ŸÅÿßÿ±ÿ≥€å
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/it/">
              Italiano
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/th/">
              ‡πÑ‡∏ó‡∏¢
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/pl/">
              Polski
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/uk/">
              –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/ro/">
              Rom√¢nƒÉ
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/nl/">
              Nederlands
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/sv/">
              Svenska
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/cs/">
              ƒåe≈°tina
            </a>
            <a class="navbar-item" href="https://ts-rf.github.io/he/">
              ◊¢◊ë◊®◊ô◊™
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <section class="hero reveal">
    <div class="hero-body" style="padding-top: 1rem;">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">
              Thermodynamic Simulation-Assisted Random Forest: Interpretable Fault Diagnosis for Marine Diesel Engine Combustion Chamber Components
            </h1>
            <div class="is-size-5 publication-authors">
        <span class="author-block">
         <strong>
          Congcong Luo
         </strong>
         <sup>
          a
         </sup>
         ,
        </span>
              <span class="author-block">
         <a href="https://homepage.hit.edu.cn/zhaominghang?lang=en" style="color: inherit; text-decoration: underline;" target="_blank">
          <strong>
           Minghang Zhao
          </strong>
         </a>
         <sup>
          a,*
         </sup>
         ,
        </span>
              <span class="author-block">
         <strong>
          Xuyun Fu
         </strong>
         <sup>
          a
         </sup>
         ,
        </span>
              <span class="author-block">
         <strong>
          Shisheng Zhong
         </strong>
         <sup>
          a
         </sup>
         ,
        </span>
              <span class="author-block">
         <strong>
          Song Fu
         </strong>
         <sup>
          b
         </sup>
         ,
        </span>
              <span class="author-block">
         <strong>
          Kai Zhang
         </strong>
         <sup>
          c
         </sup>
         ,
        </span>
              <span class="author-block">
         <strong>
          Xiaoxia Yu
         </strong>
         <sup>
          d
         </sup>
        </span>
            </div>
            <div class="is-size-6 publication-authors" style="font-size: 0.8rem; line-height: 1.5;">
        <span class="author-block">
         <sup>
          a
         </sup>
         Department of Mechanical Engineering, Harbin Institute of Technology, Weihai, Weihai 264209, China
        </span>
              <br/>
              <span class="author-block">
         <sup>
          b
         </sup>
         School of Mechatronics Engineering, Harbin Institute of Technology, Harbin 150001, China
        </span>
              <br/>
              <span class="author-block">
         <sup>
          c
         </sup>
         School of Mechanical Engineering, Southwest Jiaotong University, Chengdu 610031, China
        </span>
              <br/>
              <span class="author-block">
         <sup>
          d
         </sup>
         School of Mechanical Engineering, Chongqing University of Technology, Chongqing 400054, China
        </span>
            </div>
            <div class="column has-text-centered">
              <div class="publication-links">
         <span class="link-block">
          <a class="button is-normal is-rounded is-dark hover-card" href="../TSRF.pdf" target="_blank">
           <span class="icon">
            <i class="fas fa-file-pdf">
            </i>
           </span>
           <span>
            Full Paper
           </span>
          </a>
         </span>
                <span class="link-block">
          <a class="button is-normal is-rounded is-dark hover-card" href="https://github.com/TS-RF/TS-RF.github.io/releases/tag/DATASET" target="_blank">
           <span class="icon">
            <i class="fas fa-file-csv">
            </i>
           </span>
           <span>
            Dataset
           </span>
          </a>
         </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section" style="padding-top: 0rem; margin-top: 0rem;">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3 reveal">
            Abstract
          </h2>
          <div class="content has-text-justified reveal delay-1">
            <p>
              Traditional intelligent fault diagnosis methods for marine diesel engines often suffer from poor generalization capabilities due to the scarcity of fault training samples. Furthermore, their interpretability is limited by the failure to fully integrate prior knowledge from the domain of fault mechanisms. To address these issues, this paper proposes a
              <strong>
                Thermodynamic Simulation-Assisted Random Forest (TSRF)
              </strong>
              method.
            </p>
            <p>
              This approach utilizes thermodynamic simulation to reveal fault evolution characteristics, integrating them as prior knowledge into the design of the intelligent diagnosis model. First, five thermodynamic fault models were developed by fine-tuning basic system parameters to simulate the distinct features of different faults. Subsequently, potential thermodynamic indicators characterizing the degradation of combustion chamber components were identified based on numerical simulation results.
            </p>
            <p>
              Feature selection was performed by calculating SHapley Additive explanations (SHAP) values, retaining only those variables significantly correlated with fault states. Finally, the selected parameters were used to assess the health status of the combustion chamber. Experimental results demonstrate that the proposed TSRF method achieves superior classification performance, with an average accuracy of 99.07% on the fault dataset.
            </p>
            <div class="keywords-container" style="margin-top: 2rem;">
        <span class="keyword-label">
         Keywords:
        </span>
              <div class="tags is-inline-block">
         <span class="tag is-light is-info">
          Marine Diesel Engine
         </span>
                <span class="tag is-light is-info">
          Fault Diagnosis
         </span>
                <span class="tag is-light is-info">
          Explainable AI
         </span>
                <span class="tag is-light is-info">
          SHAP Values
         </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section" style="padding-top: 1rem; margin-top: 1rem;">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3 reveal">
            Motivation
          </h2>
          <div class="content has-text-justified reveal delay-1">
            <p>
              In the fields of Ocean Engineering and Prognostics and Health Management (PHM), the industry faces two persistent bottlenecks:
            </p>
            <ul>
              <li>
                <strong>
                  Data Scarcity:
                </strong>
                Marine diesel engines (especially main engines on ocean-going vessels) are the heart of the ship. Serious failures at sea can lead to power loss, grounding, or maritime disasters. Consequently, they are designed with extremely high safety factors, making the probability of intrinsic catastrophic failure very low. Furthermore, the shipping industry adheres to strict preventive maintenance regimes (e.g., time-based overhauls). Most worn components are mandatorily replaced before they deteriorate enough to generate actual fault data. This results in an abundance of 'healthy' and 'early-stage wear' data, but a severe lack of real-world data representing complete failures or critical faults.
              </li>
              <li>
                <strong>
                  The "Black Box" Problem:
                </strong>
                Due to the lack of transparency in deep learning models, it is difficult for engineers to trust a system if they cannot explain the physical root cause of a fault. In the shipping industry, which is strictly regulated by Classification Societies, this opacity is critical. If an AI misdiagnosis leads to cylinder scuffing or crankshaft fracture, and the system cannot trace whether the error originated from data bias, algorithmic defects, or sensor drift, such non-traceability is unacceptable in maritime accident investigations.
              </li>
            </ul>
            <p>
              To address these challenges, we proposed the TSRF method. By integrating physics-based mechanistic models with advanced interpretability techniques and utilizing high-fidelity simulations, we solve the data scarcity problem while ensuring diagnostic decisions align with fundamental thermodynamic principles.
            </p>
          </div>
        </div>
      </div>
      <hr/>
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3 reveal">
            Methodology
          </h2>
          <div class="content has-text-justified reveal delay-1">
            <p>
              The workflow of this study consists of four main phases (as shown in the figure):
            </p>
            <ol>
              <li>
                <strong>
                  Thermodynamic Modeling:
                </strong>
                Instead of relying solely on physical test beds, we constructed a high-fidelity 1D thermodynamic model of a six-cylinder marine diesel engine. This model was rigorously calibrated based on real-world operating data, keeping simulation errors within 5%.
              </li>
              <li>
                <strong>
                  Fault Injection:
                </strong>
                Based on the calibrated model, we simulated five specific combustion chamber faults (e.g., Cylinder Head Cracks, Piston Ablation) by fine-tuning physical parameters. This generated a dataset covering various degrees of fault severity.
              </li>
              <li>
                <strong>
                  SHAP-based Feature Selection:
                </strong>
                We utilized SHAP values to quantitatively identify key features, filtering out 14 critical parameters that dominate the diagnostic decision-making process.
              </li>
              <li>
                <strong>
                  Classification Diagnosis:
                </strong>
                Utilizing this physics-enhanced dataset, we trained a Random Forest (RF) classifier, achieving high-precision fault diagnosis.
              </li>
            </ol>
          </div>
          <div class="has-text-centered reveal delay-2">
            <img alt="Structure of TSRF method combining Thermodynamic Simulation and Random Forest for Explainable AI" class="hover-card" src="../static/images/fig1_structure.jpg" style="width:100%; height:auto; border-radius: 10px;"/>
            <p class="subtitle is-6">
              <strong>
                Figure 1:
              </strong>
              Architecture of the TSRF method.
            </p>
          </div>
        </div>
      </div>
      <hr/>
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3 reveal">
            Thermodynamic Modeling Details
          </h2>
          <div class="content has-text-justified reveal delay-1">
            <p>
              To ensure high fidelity, we constructed a 1D diesel engine simulation model. This mechanistic model strikes a balance between physical accuracy and the computational efficiency required for dataset generation.
            </p>
          </div>
          <div class="columns is-centered">
            <div class="column is-6 reveal delay-2">
              <div class="box hover-card" style="height: 100%;">
                <h4 class="title is-4 is-size-5">
          <span class="icon has-text-info" style="margin-right: 8px;">
           <i class="fas fa-network-wired">
           </i>
          </span>
                  Model Topology
                </h4>
                <div class="content is-size-6">
                  <p>
                    The engine system is discretized into a network of fluid pipes and functional components:
                  </p>
                  <ul>
                    <li>
                      <strong>
                        Core Power Unit:
                      </strong>
                      Six-cylinder, two-stroke in-line configuration.
                    </li>
                    <li>
                      <strong>
                        Air Path System:
                      </strong>
                      Intake/Exhaust manifolds (PL1, PL2) connected via an intricate piping network.
                    </li>
                    <li>
                      <strong>
                        Turbocharging System:
                      </strong>
                      Turbocharger (TC1) coupled with an intercooler (CO1).
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="column is-6 reveal delay-3">
              <div class="box hover-card" style="height: 100%;">
                <h4 class="title is-4 is-size-5">
          <span class="icon has-text-success" style="margin-right: 8px;">
           <i class="fas fa-check-double">
           </i>
          </span>
                  Calibration &amp; Validation
                </h4>
                <div class="content is-size-6">
                  <p>
                    Before fault injection, the baseline model was rigorously calibrated against measured data.
                  </p>
                  <ul>
                    <li>
                      <strong>
                        Data Source:
                      </strong>
                      Real ship operation data acquired via a Data Acquisition Module (DCM).
                    </li>
                    <li>
                      <strong>
                        Validation:
                      </strong>
                      Deviations in key parameters (e.g., power, exhaust temperature) were strictly controlled
                      <strong>
                        within a ¬±5% error margin
                      </strong>
                      .
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="columns is-centered reveal" style="margin-top: 1rem; margin-bottom: 1rem;">
            <div class="column is-8 has-text-centered">
              <div style="height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
                <img alt="1-D thermodynamic simulation model" class="hover-card" src="../static/images/fig2_simulator.png" style="height: 100%; width: auto; max-width: 100%; object-fit: contain; border-radius: 8px;"/>
              </div>
              <p class="subtitle is-6">
                <strong>
                  Figure 2:
                </strong>
                Schematic of the 1D thermodynamic model of the diesel engine.
              </p>
            </div>
            <div class="column is-4 has-text-centered">
              <div style="height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
                <img alt="Model Validation Results" class="hover-card" src="../static/images/fig5_faults.jpg" style="height: 100%; width: auto; max-width: 100%; object-fit: contain; border-radius: 8px;"/>
              </div>
              <p class="subtitle is-6">
                <strong>
                  Figure 5:
                </strong>
                Data Acquisition Module (DCM).
              </p>
            </div>
          </div>
          <div class="box hover-card reveal" style="margin-top: 1.5rem;">
            <h4 class="title is-4 is-size-5" style="display: flex; align-items: center; justify-content: center;">
        <span class="icon has-text-black" style="margin-right: 8px;">
         <i class="fas fa-cogs">
         </i>
        </span>
              <span>
         Fault Injection Mechanism
        </span>
            </h4>
            <div class="content has-text-justified is-size-6">
              <p>
                Since 1D models cannot directly represent 3D structural defects, we employed a phenomenological mapping approach, translating physical degradation mechanisms into equivalent thermodynamic parameter offsets.
              </p>
            </div>
            <div class="table-container">
              <table class="table is-fullwidth is-striped is-hoverable is-size-6">
                <thead>
                  <tr style="background-color: #f5f5f5;">
                    <th style="width: 20%;">
                      Fault Type
                    </th>
                    <th style="width: 35%;">
                      Physical Mechanism
                    </th>
                    <th>
                      Modeling Implementation
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <strong>
                        F1: Cylinder Head Crack
                      </strong>
                    </td>
                    <td>
                      Impeded heat transfer.
                    </td>
                    <td>
                      Increase cylinder head surface temperature ($T_H$) to 346&amp;deg;C.
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong>
                        F2: Piston Ablation
                      </strong>
                    </td>
                    <td>
                      Material loss and sealing failure.
                    </td>
                    <td>
                      Increase piston temperature ($T_P$) + Slight blow-by (0.01 kg/s).
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong>
                        F3: Liner Wear
                      </strong>
                    </td>
                    <td>
                      Bore enlargement due to wear.
                    </td>
                    <td>
                      Increase cylinder bore + Significant blow-by (0.03 kg/s).
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong>
                        F4: Piston Ring Wear
                      </strong>
                    </td>
                    <td>
                      Gas leakage.
                    </td>
                    <td>
                      Adjust blow-by mass flow rate (0.02 kg/s).
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <strong>
                        F5: Ring Sticking
                      </strong>
                    </td>
                    <td>
                      Increased friction and sealing failure.
                    </td>
                    <td>
                      Cylinder bore change + Increased liner temperature + Blow-by.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <hr/>
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3 reveal">
            Explainability Analysis
          </h2>
          <div class="content has-text-justified reveal delay-1">
            <p>
              A core innovation of this study is shifting the focus from "What is the fault?" to "Why was this fault predicted?". We demonstrated this capability through the analysis of Piston Ring Wear (F4):
            </p>
            <ul>
              <li>
                <strong>
                  Local Explanation (Waterfall Plot):
                </strong>
                The waterfall plot parses the specific prediction logic. For instance, the model predicts "Piston Ring Wear" because the Blow-by Heat Flow (P06) and Blow-by Mass Flow (P07) exhibit specific values, thereby increasing the probability of this fault prediction. This aligns with physical laws: worn rings compromise sealing, leading to gas leakage (blow-by).
              </li>
              <li>
                <strong>
                  Global Explanation (Beeswarm Plot):
                </strong>
                Global analysis reveals universal patterns learned by the model. We found that low pre-turbine exhaust pressure (P11) is a strong indicator of piston ring wear. From a physical perspective, this is consistent: leaking gas reduces the energy available to drive the turbine.
              </li>
            </ul>
          </div>
          <div class="has-text-centered reveal delay-2">
            <img alt="SHAP Analysis,including Waterfall plot, beeswarm plot, interaction plot and dependence plot" class="hover-card" src="../static/images/fig11_shap.jpg" style="width:100%; border-radius: 10px;"/>
            <p class="subtitle is-6">
              <strong>
                Figure 11:
              </strong>
              SHAP-based analysis of Piston Ring Wear (F4): (a) Waterfall plot; (b) Beeswarm plot; (c) Interaction plot; (d) Dependence plot.
            </p>
          </div>
          <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/xcode.min.css" rel="stylesheet"/>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js">
          </script>
          <script>
            hljs.highlightAll();
          </script>
          <div class="reveal delay-2" style="margin-top: 2rem; margin-bottom: 2rem;">
            <details class="box hover-card" style="background-color: #fcfcfc; border: 1px solid #eee;">
              <summary class="title is-5 is-size-6-mobile" style="cursor: pointer; color: #363636; margin-bottom: 0;">
         <span class="icon has-text-info" style="margin-right: 0.5rem;">
          <i class="fas fa-code">
          </i>
         </span>
                <span>
          Click to view SHAP visualization code (Python)
         </span>
              </summary>
              <div class="content has-text-left" style="margin-top: 1.5rem;">
                <p>
                <p>
                  If you are interested in the implementation details of the charts above, below is the example code used to generate the waterfall, beeswarm, interaction, and dependence plots. üëá
                </p>
                </p>
                <pre style="padding: 0; border-radius: 8px; overflow: hidden;"><code class="language-python" style="border-radius: 8px; font-size: 0.85rem; line-height: 1.5;">import shap
import matplotlib.pyplot as plt
import numpy as np

# --- 0. Setup &amp; Global Settings ---
plt.rcParams['font.family'] = 'Arial'
plt.rcParams['font.size'] = '24'
plt.rcParams['axes.unicode_minus'] = False

# Assumption: 'best_model' is your trained XGBoost/RF model
# Assumption: 'X_train' and 'X_test' are pandas DataFrames

# 1. Calculate SHAP values as Numpy Arrays (for Beeswarm, Dependence, Interaction)
explainer_tree = shap.TreeExplainer(best_model)
shap_values_numpy = explainer_tree.shap_values(X_train)

# 2. Calculate SHAP values as Explanation Object (Specifically for Waterfall)
explainer_obj = shap.Explainer(best_model, X_test)
shap_values_obj = explainer_obj(X_test)


##################################################################
#                                                                #
#                      (a) Waterfall Plot                        #
#          Visualizes contribution for a single sample           #
#                                                                #
##################################################################

class_idx = 4  # Target class
sample_idx = 3 # Specific sample to explain

plt.figure()
shap.plots.waterfall(
    shap_values_obj[sample_idx, :, class_idx],
    max_display=9,
    show=False
)

# Customizing style
ax = plt.gca()
ax.set_xlabel(ax.get_xlabel(), fontsize=36)
ax.set_ylabel(ax.get_ylabel(), fontsize=36)
ax.spines['bottom'].set_linewidth(3)
plt.show()


##################################################################
#                                                                #
#                      (b) Beeswarm Plot                         #
#              Global summary of feature importance              #
#                                                                #
##################################################################

class_idx = 5
plt.figure(figsize=(10, 8))

shap.summary_plot(
    shap_values_numpy[..., class_idx],
    X_train,
    feature_names=X_train.columns,
    plot_type="dot",
    show=False,
    cmap='Greys' # or 'plasma'
)

# Customize Color Bar
cbar = plt.gcf().axes[-1]
cbar.set_ylabel('Parameter Value', fontsize=24)
cbar.tick_params(labelsize=20)
plt.show()


##################################################################
#                                                                #
#                     (c) Interaction Plot                       #
#          Visualizes interaction effects between features       #
#                                                                #
##################################################################

# Note: Calculation can be expensive
shap_interaction_values = explainer_tree.shap_interaction_values(X_test)
class_idx = 4

plt.figure()
shap.summary_plot(
    shap_interaction_values[..., class_idx],
    X_test,
    show=False,
    max_display=6,
    cmap='Greys'
)

# Clean up subplots
axes = plt.gcf().axes
for ax in axes:
    ax.spines['bottom'].set_linewidth(2)
    ax.tick_params(axis="x", labelsize=18, width=2)
    ax.set_title(ax.get_title(), fontsize=14)

plt.subplots_adjust(wspace=0.3, hspace=0.4)
plt.show()


##################################################################
#                                                                #
#                     (d) Dependence Plot                        #
#           Feature relationship colored by interaction          #
#                                                                #
##################################################################

Feature_X = 'P06'  # Main feature
Feature_Y = 'P07'  # Interaction feature
class_idx = 4

shap.dependence_plot(
    Feature_X,
    shap_values_numpy[..., class_idx],
    X_train,
    interaction_index=Feature_Y,
    dot_size=100,
    show=False
)

# Customize Axes
ax = plt.gca()
ax.tick_params(axis='both', which='major', labelsize=36, width=2)
ax.set_ylabel(f'SHAP value ({Feature_X})', fontsize=36)
ax.spines['bottom'].set_linewidth(3)
ax.spines['left'].set_linewidth(3)
plt.show()


##################################################################
#                                                                #
#            (e) Advanced Composite Plot (Beeswarm + Bar)        #
#      Combines Beeswarm (Bottom Axis) &amp; Importance (Top Axis)   #
#                                                                #
##################################################################

class_idx = 5
fig, ax1 = plt.subplots(figsize=(10, 8))

# 1. Main Beeswarm Plot (on ax1)
shap.summary_plot(
    shap_values_numpy[..., class_idx],
    X_train,
    feature_names=X_train.columns,
    plot_type="dot",
    show=False,
    color_bar=True,
    cmap='Greys' # or 'plasma'
)

# Customize Color Bar
cbar = plt.gcf().axes[-1]
cbar.set_ylabel('Parameter Value', fontsize=24)
cbar.tick_params(labelsize=20)

# Adjust layout to make room for the top axis
plt.gca().set_position([0.2, 0.2, 0.65, 0.65])

# 2. Feature Importance Bar Plot (on Top Axis ax2)
# Create a twin axis sharing the y-axis
ax2 = ax1.twiny()

shap.summary_plot(
    shap_values_numpy[..., class_idx],
    X_train,
    plot_type="bar",
    show=False
)

# Align position with the main plot
plt.gca().set_position([0.2, 0.2, 0.65, 0.65])

# Style the bars (Transparent &amp; Light Color)
bars = ax2.patches
for bar in bars:
    bar.set_color('#CCE5FB') # Light blue background bars
    bar.set_alpha(0.4)       # Transparency

# Customize Axes Labels
ax1.set_xlabel(f'Shapley Value Contribution (F{class_idx})', fontsize=24, labelpad=5)
ax1.set_ylabel('Parameters', fontsize=24)
ax2.set_xlabel('Mean Shapley Value (Parameter Importance)', fontsize=24, labelpad=10)

# Move ax2 (Bar plot axis) to the top
ax2.xaxis.set_label_position('top')
ax2.xaxis.tick_top()

# Ensure ax1 (dots) is drawn ON TOP OF ax2 (bars)
ax1.set_zorder(ax1.get_zorder() + 1)
ax1.patch.set_visible(False) # Make ax1 background transparent

plt.show()</code></pre>
              </div>
            </details>
          </div>
        </div>
      </div>
      <hr/>
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3 reveal">
            Highlights
          </h2>
          <div class="content has-text-justified reveal delay-1">
            <p>
            <p>
              We believe this work makes the following key contributions to the field:
            </p>
            </p>
            <ul class="highlight-list stagger-wrapper">
              <li class="stagger-item hover-card">
                <strong>
                  Established parameterized models for five typical faults in marine diesel engine combustion chamber components.
                </strong>
              </li>
              <li class="stagger-item hover-card">
                <strong>
                  Validated the effectiveness of the SHAP method through comparison with multiple feature selection techniques.
                </strong>
              </li>
              <li class="stagger-item hover-card">
                <strong>
                  Provided a new perspective for interpretable fault diagnosis by integrating data-driven methods with thermodynamic mechanistic models.
                </strong>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="section reveal" id="BibTeX" style="padding-top: 0; margin-top: -2rem;">
    <div class="container is-max-desktop content">
      <hr/>
      <h2 class="title">
        Citation
      </h2>
      <div class="citation-prompt">
     <span class="icon is-small" style="margin-right: 0.5rem; color: #3273dc;">
      <i class="fas fa-quote-left">
      </i>
     </span>
        If you find this work useful for your research, please consider citing it üòä
      </div>
      <h4 class="title is-5 is-size-6-mobile" style="margin-bottom: 0.5rem; color: #666;">
        BibTeX
      </h4>
      <pre style="margin-bottom: 5px; background-color: #fcfcfc; border: 1px solid #e5e5e5; border-radius: 8px; padding: 1.25rem;"><code class="language-latex" id="bibtex-source" style="font-family: 'Times New Roman', Times, serif !important; font-size: 16px; line-height: 1.5;">@article{luo2025thermodynamic,
  title     = {Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines},
  author    = {Luo, Congcong and Zhao, Minghang and Fu, Xuyun and Zhong, Shisheng and Fu, Song and Zhang, Kai and Yu, Xiaoxia},
  journal   = {Measurement},
  volume    = {251},
  pages     = {117252},
  year      = {2025},
  publisher = {Elsevier},
  doi       = {10.1016/j.measurement.2025.117252},
}</code></pre>
      <div class="level is-mobile" style="margin-top: 10px; margin-bottom: 2rem;">
        <div class="level-left">
          <button class="button is-dark is-small is-rounded" onclick="copyText('bibtex-source', this)">
       <span class="icon is-small">
        <i class="fas fa-copy">
        </i>
       </span>
            <span class="btn-text">
        Copy BibTeX
       </span>
          </button>
        </div>
      </div>
      <h4 class="title is-5 is-size-6-mobile" style="margin-bottom: 0.5rem; color: #666;">
        Standard Format
      </h4>
      <div class="box" style="background-color: #fcfcfc; border: 1px solid #e5e5e5; padding: 1.25rem; margin-bottom: 5px;">
        <p id="standard-citation" style="margin-bottom: 0; font-family: 'Times New Roman', Times, serif; font-size: 16px; line-height: 1.5;">
          C. Luo, M. Zhao, X. Fu, S. Zhong, S. Fu, K. Zhang, X. Yu. Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines[J]. Measurement, 2025, 251: 117252.
        </p>
      </div>
      <div class="level is-mobile" style="margin-top: 10px;">
        <div class="level-left">
          <button class="button is-dark is-small is-rounded" onclick="copyText('standard-citation', this)">
       <span class="icon is-small">
        <i class="fas fa-copy">
        </i>
       </span>
            <span class="btn-text">
        Copy Text
       </span>
          </button>
          <a class="button is-text is-small" href="https://www.sciencedirect.com/science/article/pii/S0263224125006116" style="text-decoration: none; margin-left: 10px;" target="_blank">
       <span class="icon has-text-info">
        <i class="fas fa-external-link-alt">
        </i>
       </span>
            <span>
        View on ScienceDirect
       </span>
          </a>
        </div>
      </div>
    </div>
  </section>
  <style>
    .citation-prompt {
     background-color: #f5f5f5;
     border-left: 5px solid #3273dc;
     padding: 1rem 1.5rem;
     margin-bottom: 2rem;
     border-radius: 4px;
     font-size: 1.1rem;
     color: #4a4a4a;
     font-weight: 500;
   }
   /* Á°Æ‰øù pre Ê†áÁ≠æ‰∏ç‰ºöÂõ†‰∏∫Ê°ÜÊû∂Ê†∑ÂºèÂπ≤Êâ∞ padding */
   pre {
       padding: 1.25rem !important;
   }
  </style>
  <script>
    function copyText(elementId, btn) {
     const textToCopy = document.getElementById(elementId).innerText;
     navigator.clipboard.writeText(textToCopy).then(() => {
       const icon = btn.querySelector('.fa-copy');
       const text = btn.querySelector('.btn-text');
       const originalText = text.innerText;
 
       if(icon) {
         icon.classList.remove('fa-copy');
         icon.classList.add('fa-check');
       }
       if(text) text.innerText = "Copied!";
 
       btn.classList.remove('is-dark');
       btn.classList.add('is-success');
 
       setTimeout(() => {
         if(icon) {
           icon.classList.remove('fa-check');
           icon.classList.add('fa-copy');
         }
         if(text) text.innerText = originalText;
         btn.classList.remove('is-success');
         btn.classList.add('is-dark');
       }, 2000);
     }).catch(err => {
       console.error('Failed to copy: ', err);
     });
   }
  </script>
  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <a class="icon-link" href="https://doi.org/10.1016/j.measurement.2025.117252">
          <i class="fas fa-file-pdf">
          </i>
        </a>
        <a class="external-link" disabled="" href="#">
          <i class="fab fa-github">
          </i>
        </a>
      </div>
      <div class="columns is-centered is-vcentered">
        <div class="column is-6">
          <div class="content">
            <p>
              This website is licensed under a
              <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license">
                Creative
                Commons Attribution-ShareAlike 4.0 International License
              </a>
              .
            </p>
            <p>
              Copyright ¬© 2025 Congcong Luo et al. Published in
              <a href="https://doi.org/10.1016/j.measurement.2025.117252" target="_blank">
                Measurement
              </a>
              .
            </p>
            <p>
              This website is adapted from the
              <a href="https://github.com/nerfies/nerfies.github.io">
                Nerfies
              </a>
              project page template.
            </p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
              <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
              </script>
              <span id="busuanzi_container_site_uv" style="display:none">
         Visitors:
         <span id="busuanzi_value_site_uv" style="font-weight: bold;">
         </span>
        </span>
              <span style="margin: 0 8px; color: #ccc;">
         |
        </span>
              <span id="busuanzi_container_site_pv" style="display:none">
         Total Visits:
         <span id="busuanzi_value_site_pv" style="font-weight: bold;">
         </span>
        </span>
            </p>
          </div>
        </div>
        <div class="column is-2">
          <div style="width: 100%; max-width: 200px; margin: 0 auto 0 0;">
            <script id="clstr_globe" src="//clustrmaps.com/globe.js?d=_zkZv1bfxiqAq8HXllAuUZNIvCYv603-zyA7z-Vpjfw" type="text/javascript">
            </script>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
     const observer = new IntersectionObserver((entries) => {
         entries.forEach(entry => {
             if (entry.isIntersecting) {
                 entry.target.classList.add('active');
 
             }
         });
     }, {
         threshold: 0.1
     });
 
     // ÁõëÂê¨ reveal Á±ªÂíå stagger-wrapper Á±ª
     document.querySelectorAll('.reveal, .stagger-wrapper').forEach(el => {
         observer.observe(el);
     });
 });
  </script>
</body>
</html>
