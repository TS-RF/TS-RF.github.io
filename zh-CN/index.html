<!DOCTYPE html>
<html lang="zh-CN">
<head>

  <link rel="alternate" hreflang="en" href="https://ts-rf.github.io/" />
  <link rel="alternate" hreflang="zh-CN" href="https://ts-rf.github.io/zh/" />
  <link rel="alternate" hreflang="x-default" href="https://ts-rf.github.io/" />

  <meta property="og:title" content="TSRF: ËàπÁî®Êü¥Ê≤πÊú∫ÂèØËß£ÈáäÊÄßÊïÖÈöúËØäÊñ≠">
  <meta property="og:description" content="ÁªìÂêàÁÉ≠ÂäõÂ≠¶‰ªøÁúü‰∏é SHAPÔºåÂÆûÁé∞ËàπÁî®ÂèëÂä®Êú∫ÂÅ•Â∫∑ÁÆ°ÁêÜÁöÑÂêÑÈ°πÂºÇÊÄß‰∫∫Â∑•Êô∫ËÉΩ„ÄÇ">
  <meta property="og:image" content="https://ts-rf.github.io/static/images/fig1_structure.jpg"> <meta property="og:url" content="https://ts-rf.github.io/">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  
  <meta charset="utf-8">
  <meta name="description"
        content="TSRFÔºö‰∏ÄÁßçÁî®‰∫éËàπÁî®Êü¥Ê≤πÊú∫ÊïÖÈöúËØäÊñ≠ÁöÑÁâ©ÁêÜ‰ø°ÊÅØÊú∫Âô®Â≠¶‰π†ÔºàPIMLÔºâÊñπÊ≥ï„ÄÇÁªìÂêàÁÉ≠ÂäõÂ≠¶‰ªøÁúüÔºàÊú∫ÁêÜÊ®°ÂûãÔºâ‰∏éÈöèÊú∫Ê£ÆÊûóÂèä SHAPÔºåÂÆûÁé∞ÂèØËß£ÈáäÊÄß AI (XAI) Âπ∂Ëß£ÂÜ≥È¢ÑÊµãÊÄßÁª¥Êä§‰∏≠ÁöÑÊï∞ÊçÆÁ®ÄÁº∫ÈóÆÈ¢ò„ÄÇ">
  <meta name="keywords" content="ËàπÁî®Êü¥Ê≤πÊú∫, ÊïÖÈöúËØäÊñ≠, ÈöèÊú∫Ê£ÆÊûó, SHAP, ÂèØËß£ÈáäÊÄßAI, XAI, Áâ©ÁêÜ‰ø°ÊÅØÊú∫Âô®Â≠¶‰π†, PIML, Êú∫ÁêÜÊ®°Âûã, ÂêàÊàêÊï∞ÊçÆÁîüÊàê, È¢ÑÊµãÊÄßÁª¥Êä§, ÁÉ≠ÂäõÂ≠¶‰ªøÁúü, AVL BOOST">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TSRF: Explainable Fault Diagnosis for Marine Diesel Engines</title>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="../static/css/bulma.min.css">
  <link rel="stylesheet" href="../static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="../static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="../static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="../static/css/index.css">
  <link rel="icon" href="../static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="../static/js/fontawesome.all.min.js"></script>
  <script src="../static/js/bulma-carousel.min.js"></script>
  <script src="../static/js/bulma-slider.min.js"></script>
  <script src="../static/js/index.js"></script>

  <style>
      .keyword-label {
      font-weight: bold;
      margin-right: 10px;
      vertical-align: middle;
      color: #363636;
    }
    
    .tags .tag {
      transition: all 0.2s ease;
      font-size: 0.9rem;
    }
    
    .tags .tag:hover {
      background-color: #3273dc;
      color: #fff;
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(50, 115, 220, 0.2);
    }
    
    /* Ê†∏ÂøÉÂä®ÁîªÁ±ª */
    .reveal {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .reveal.active {
      opacity: 1;
      transform: translateY(0);
    }

    /* ÁÆÄÂçïÁöÑÂª∂ËøüÁ±ª */
    .reveal.delay-1 { transition-delay: 0.1s; }
    .reveal.delay-2 { transition-delay: 0.2s; }
    .reveal.delay-3 { transition-delay: 0.3s; }

    .hover-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      will-change: transform;
    }
    
    .hover-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px -10px rgba(0,0,0,0.2);
    }

    .highlight-list li {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border-left: 4px solid #3273dc;
    }

    .stagger-wrapper .stagger-item {
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.6s ease-out;
    }

    .stagger-wrapper.active .stagger-item {
      opacity: 1;
      transform: translateX(0);
    }

    .stagger-wrapper.active .stagger-item:nth-child(1) { transition-delay: 0.1s; }
    .stagger-wrapper.active .stagger-item:nth-child(2) { transition-delay: 0.3s; }
    .stagger-wrapper.active .stagger-item:nth-child(3) { transition-delay: 0.5s; }

  </style>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ScholarlyArticle",
    "headline": "Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines",
    "image": [
      "https://ts-rf.github.io/static/images/fig1_structure.jpg"
    ],
    "datePublished": "2025-01-01",
    "author": [
      {"@type": "Person", "name": "Congcong Luo"},
      {"@type": "Person", "name": "Minghang Zhao"},
      {"@type": "Person", "name": "Xuyun Fu"}
    ],
    "publisher": {
      "@type": "Organization",
      "name": "Elsevier Measurement"
    },
    "description": "A physics-informed machine learning approach using SHAP for explainable fault diagnosis in marine diesel engines."
  }
  </script>
  
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  
  <div class="navbar-menu">
    
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://scholar.google.com/citations?hl=zh-CN&user=k82TzLwAAAAJ" target="_blank">
        <span class="icon" style="margin-right: 0.3rem;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/c/c7/Google_Scholar_logo.svg" alt="Google Scholar" style="height: 20px; width: 20px;">
        </span>
        <span>Minghang Zhao (Google Scholar)</span>
      </a>
    </div>

    <div class="navbar-dropdown">
      <a class="navbar-item" href="https://ts-rf.github.io/">
        English
      </a>
      <a class="navbar-item" href="https://ts-rf.github.io/zh-CN/">
        ÁÆÄ‰Ωì‰∏≠Êñá
      </a>
      <a class="navbar-item" href="https://ts-rf.github.io/zh-TW/">
        ÁπÅÈ´î‰∏≠Êñá
      </a>
      
      <hr class="navbar-divider">
      
      <a class="navbar-item" href="https://ts-rf.github.io/ar/">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)</a>
      <a class="navbar-item" href="https://ts-rf.github.io/cs/">ƒåe≈°tina</a>
      <a class="navbar-item" href="https://ts-rf.github.io/de/">Deutsch</a>
      <a class="navbar-item" href="https://ts-rf.github.io/es/">Espa√±ol</a>
      <a class="navbar-item" href="https://ts-rf.github.io/fa/">ŸÅÿßÿ±ÿ≥€å (Persian)</a>
      <a class="navbar-item" href="https://ts-rf.github.io/fr/">Fran√ßais</a>
      <a class="navbar-item" href="https://ts-rf.github.io/he/">◊¢◊ë◊®◊ô◊™ (Hebrew)</a>
      <a class="navbar-item" href="https://ts-rf.github.io/hi/">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</a>
      <a class="navbar-item" href="https://ts-rf.github.io/id/">Indonesia</a>
      <a class="navbar-item" href="https://ts-rf.github.io/it/">Italiano</a>
      <a class="navbar-item" href="https://ts-rf.github.io/ja/">Êó•Êú¨Ë™û</a>
      <a class="navbar-item" href="https://ts-rf.github.io/ko/">ÌïúÍµ≠Ïñ¥</a>
      <a class="navbar-item" href="https://ts-rf.github.io/nl/">Nederlands</a>
      <a class="navbar-item" href="https://ts-rf.github.io/pl/">Polski</a>
      <a class="navbar-item" href="https://ts-rf.github.io/pt/">Portugu√™s</a>
      <a class="navbar-item" href="https://ts-rf.github.io/ro/">Rom√¢nƒÉ</a>
      <a class="navbar-item" href="https://ts-rf.github.io/ru/">–†—É—Å—Å–∫–∏–π</a>
      <a class="navbar-item" href="https://ts-rf.github.io/sv/">Svenska</a>
      <a class="navbar-item" href="https://ts-rf.github.io/th/">‡πÑ‡∏ó‡∏¢ (Thai)</a>
      <a class="navbar-item" href="https://ts-rf.github.io/tr/">T√ºrk√ße</a>
      <a class="navbar-item" href="https://ts-rf.github.io/uk/">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</a>
      <a class="navbar-item" href="https://ts-rf.github.io/vi/">Ti·∫øng Vi·ªát</a>
    </div> 
  </div>
</nav>


<section class="hero reveal"> 
  <div class="hero-body" style="padding-top: 1rem;">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines</h1>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block"><strong>Congcong Luo</strong><sup>a</sup>,</span>
            <span class="author-block">
              <a href="https://homepage.hit.edu.cn/zhaominghang?lang=zh" target="_blank" style="color: inherit; text-decoration: underline;"><strong>Minghang Zhao</strong></a><sup>a,*</sup>,
            </span>
            <span class="author-block"><strong>Xuyun Fu</strong><sup>a</sup>,</span>
            <span class="author-block"><strong>Shisheng Zhong</strong><sup>a</sup>,</span>
            <span class="author-block"><strong>Song Fu</strong><sup>b</sup>,</span>
            <span class="author-block"><strong>Kai Zhang</strong><sup>c</sup>,</span>
            <span class="author-block"><strong>Xiaoxia Yu</strong><sup>d</sup></span>
          </div>

          <div class="is-size-6 publication-authors" style="font-size: 0.8rem; line-height: 1.5;">
            <span class="author-block"><sup>a</sup>Department of Mechanical Engineering, Harbin Institute of Technology, Weihai 264209, China</span><br>
            <span class="author-block"><sup>b</sup>School of Mechatronics Engineering, Harbin Institute of Technology, Harbin 150001, China</span><br>
            <span class="author-block"><sup>c</sup>School of Mechanical Engineering, Southwest Jiaotong University, Chengdu 610031, China</span><br>
            <span class="author-block"><sup>d</sup>College of Mechanical Engineering, Chongqing University of Technology, Chongqing 400054, China</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://doi.org/10.1016/j.measurement.2025.117252"
                   class="button is-normal is-rounded is-dark hover-card" 
                   target="_blank">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/815177491/TSRF.github.io/releases/tag/DATA"
                   target="_blank"
                   class="button is-normal is-rounded is-dark hover-card">
                  <span class="icon">
                      <i class="fas fa-file-csv"></i>
                  </span>
                  <span>Dataset</span>
                  </a>
                </span>
                </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" style="padding-top: 0rem; margin-top: 0rem;">
    <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3 reveal">Abstract</h2>
        <div class="content has-text-justified reveal delay-1">
          <p>
            Aiming at the challenges that traditional intelligent fault diagnosis methods of marine diesel engines often suffer low generalizability due to the lack of fault training samples, as well as poor explainability due to the insufficient incorporation of domain knowledge on fault mechanism, this paper develops a 
            <strong>Thermodynamic Simulation-assisted Random Forest (TSRF)</strong>.
          </p>
          <p>
            The method reveals fault characteristics through thermodynamic simulations and incorporates them as prior knowledge when designing the intelligent fault diagnosis model. Firstly, five thermodynamic fault models are developed by fine-tuning the essential system parameters to correspond with the distinct attributes of different faults. Then, potential thermodynamic indicators of combustion chamber component degradation are identified through numerical simulation results.
          </p>
          <p>
            By calculating SHapley Additive explanations (SHAP) values, a parameter selection process is conducted to retain only those variables demonstrating significant correlations with fault states. Finally, the selected parameters are leveraged to assess the condition of the combustion chamber. The proposed TSRF achieved exceptional classification performance, illustrating a mean accuracy of 99.07% on the fault dataset.
          </p>

          <div class="keywords-container" style="margin-top: 2rem;">
            <span class="keyword-label">Keywords:</span>
            <div class="tags is-inline-block">
              <span class="tag is-light is-info">Marine Diesel Engine</span>
              <span class="tag is-light is-info">Fault Diagnosis</span>
              <span class="tag is-light is-info">Explainable AI</span>
              <span class="tag is-light is-info">SHAP</span>
            </div>
          </div>
          
        </div>
      </div>
    </div>
    </div>
</section>

<section class="section" style="padding-top: 1rem; margin-top: 1rem;">
  <div class="container is-max-desktop">

    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3 reveal">Motivation</h2>
        <div class="content has-text-justified reveal delay-1">
          <p>
            In the fields of marine engineering and Prognostics and Health Management (PHM), the industry faces two persistent bottlenecks:
          </p>
          <ul>
            <li><strong>Data Scarcity:</strong> Marine engines are high-value assets that are rarely operated to failure. This results in a critical shortage of the labeled "fault data" necessary to train robust machine learning models.</li>
            <li><strong>The "Black Box" Problem:</strong> Deep learning models often lack transparency. If an AI diagnoses a fault but cannot explain the physical reasoning, it is difficult for engineers to trust it. This lack of interpretability is a primary obstacle to widespread industry adoption.</li>
          </ul>
          <p>
            To overcome these challenges, we introduce TSRF. By fusing physics-based <strong>mechanism models</strong> with advanced XAI techniques, we address the data scarcity problem through massive synthetic data generation and ensure that diagnostic decisions align with thermodynamic principles.
          </p>
        </div>
      </div>
    </div>

    <hr>

    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3 reveal">Methodology</h2>
        
        <div class="content has-text-justified reveal delay-1">
          <p>
            Our workflow consists of four distinct stages, as illustrated below:
          </p>
          <ol>
            <li><strong>Thermodynamic Modeling:</strong> Rather than relying solely on physical test rigs, we constructed a high-fidelity 1-D thermodynamic model of a 6-cylinder marine diesel engine. The model was rigorously calibrated using real-world operational data, keeping simulation errors within 5%.</li>
            <li><strong>Fault Injection:</strong> Using the calibrated model, we simulated five specific combustion chamber faults (e.g., Head Cracking, Piston Ablation) by fine-tuning physical parameters. This enabled the generation of a comprehensive dataset covering scenarios that are impossible to capture from a real engine.</li>
            <li><strong>Feature Selection via SHAP:</strong> We utilized SHAP values to quantitatively identify the critical features‚Äîspecifically, the 14 key parameters that drive the diagnostic decision.</li>
            <li><strong>Classification:</strong> A Random Forest (RF) classifier was trained using this physics-enhanced dataset to achieve high diagnostic precision.</li>
          </ol>
        </div>
        
        <div class="has-text-centered reveal delay-2">
          <img src="../static/images/fig1_structure.jpg" class="hover-card" alt="Structure of TSRF method combining Thermodynamic Simulation and Random Forest for Explainable AI" style="width:100%; height:auto; border-radius: 10px;">
          <p class="subtitle is-6">
            <strong>Figure 1:</strong> The structure of our proposed TSRF method. It combines thermodynamic modeling with SHAP-based parameter selection.
          </p>
        </div>
      </div>
    </div>

    <hr>

    <div class="columns is-centered">
      <div class="column is-full-width">
        
        <h2 class="title is-3 reveal">Thermodynamic Modeling Details</h2>
        
        <div class="content has-text-justified reveal delay-1">
          <p>
            To ensure high fidelity, we constructed a one-dimensional (1-D) operational cycle simulation. This <strong>mechanism model</strong> balances physical accuracy with the computational efficiency required for large-scale dataset generation.
          </p>
        </div>

        <div class="columns is-centered">
          <div class="column is-6 reveal delay-2">
            <div class="box hover-card" style="height: 100%;">
              <h4 class="title is-4 is-size-5">
                <span class="icon has-text-info" style="margin-right: 8px;">
                  <i class="fas fa-network-wired"></i>
                </span>
                Model Topology
              </h4>
              <div class="content is-size-6">
                <p>The engine is discretized into a network of flow pipes and functional components:</p>
                <ul>
                  <li><strong>Core Power Unit:</strong> 6-cylinder, 2-stroke inline configuration.</li>
                  <li><strong>Air Path System:</strong> Intake/Exhaust manifolds (PL1, PL2) connected via complex piping networks.</li>
                  <li><strong>Boosting System:</strong> Turbocharger (TC1) coupled with an intercooler (CO1).</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="column is-6 reveal delay-3">
            <div class="box hover-card" style="height: 100%;">
              <h4 class="title is-4 is-size-5">
                <span class="icon has-text-success" style="margin-right: 8px;">
                  <i class="fas fa-check-double"></i>
                </span>
                Calibration & Validation
              </h4>
              <div class="content is-size-6">
                <p>Before fault injection, the baseline model was rigorously calibrated against empirical data.</p>
                <ul>
                  <li><strong>Data Source:</strong> Real-world vessel data acquired via Data Collecting Module (DCM).</li>
                  <li><strong>Validation:</strong> The deviation for critical parameters (e.g., Power, Exhaust Temp) was maintained within a <strong>&plusmn;5% error margin</strong>.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="columns is-centered reveal" style="margin-top: 1rem; margin-bottom: 1rem;">
          
          <div class="column is-8 has-text-centered">
            <div style="height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
              <img src="../static/images/fig2_simulator.png" 
                   class="hover-card" 
                   alt="1-D thermodynamic simulation model" 
                   style="height: 100%; width: auto; max-width: 100%; object-fit: contain; border-radius: 8px;">
            </div>
            <p class="subtitle is-6">
              <strong>Figure 2:</strong> One-dimensional thermodynamic model of the diesel engine.
            </p>
          </div>

          <div class="column is-4 has-text-centered">
            <div style="height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
              <img src="../static/images/fig5_faults.jpg" 
                   class="hover-card" 
                   alt="Model Validation Results" 
                   style="height: 100%; width: auto; max-width: 100%; object-fit: contain; border-radius: 8px;">
            </div>
            <p class="subtitle is-6">
              <strong>Figure 5:</strong> Data Collecting Module (DCM).
            </p>
          </div>

        </div>

        <div class="box hover-card reveal" style="margin-top: 1.5rem;">
          <h4 class="title is-4 is-size-5" style="display: flex; align-items: center; justify-content: center;">
            <span class="icon has-text-black" style="margin-right: 8px;">
              <i class="fas fa-cogs"></i>
            </span>
            <span>Fault Injection Mechanism</span>
          </h4>
          <div class="content has-text-justified is-size-6">
            <p>
              Since 1-D models cannot directly represent 3D structural defects, we employed a phenomenological mapping approach, translating physical degradation mechanisms into equivalent thermodynamic parameter shifts.
            </p>
          </div>
          
          <div class="table-container">
            <table class="table is-fullwidth is-striped is-hoverable is-size-6">
              <thead>
                <tr style="background-color: #f5f5f5;">
                  <th style="width: 20%;">Fault Type</th>
                  <th style="width: 35%;">Physical Mechanism</th>
                  <th>Modeling Implementation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>F1: Head Cracking</strong></td>
                  <td>Disrupted thermal conduction.</td>
                  <td>Elevating Cylinder Head Surface Temp ($T_H$) to 346&deg;C.</td>
                </tr>
                <tr>
                  <td><strong>F2: Piston Ablation</strong></td>
                  <td>Material loss & seal compromise.</td>
                  <td>Increasing Piston Temp ($T_P$) + minor blow-by (0.01 kg/s).</td>
                </tr>
                <tr>
                  <td><strong>F3: Liner Wear</strong></td>
                  <td>Abrasive wear increases bore.</td>
                  <td>Increasing Bore Diameter + substantial blow-by (0.03 kg/s).</td>
                </tr>
                <tr>
                  <td><strong>F4: Ring Wear</strong></td>
                  <td>Gas leakage only.</td>
                  <td>Modulation of Blow-by Mass Flow Rate (0.02 kg/s).</td>
                </tr>
                <tr>
                  <td><strong>F5: Ring Sticking</strong></td>
                  <td>Friction & seal failure.</td>
                  <td>Bore Dia. change + Elevated Liner Temp + Blow-by.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <hr>
    
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3 reveal">Explainability Analysis</h2>
        
        <div class="content has-text-justified reveal delay-1">
          <p>
            A key innovation of our work is shifting the focus from "What is the fault?" to "Why is this the fault?". We demonstrate this capability through a case study on Piston Ring Wear (F4):
          </p>
          <ul>
            <li><strong>Local Interpretation (Waterfall Plot):</strong> The waterfall plot explains specific predictions. For instance, the model predicts "Ring Wear" because Blow-by Heat Flow (P06) and Blow-by Mass Flow (P07) exhibit specific values that increase the probability. This aligns with physics: ring wear compromises the seal, leading to gas leakage (blow-by).</li>
            <li><strong>Global Interpretation (Beeswarm Plot):</strong> Global analysis reveals the general rules learned by the model. We found that low values of Pre-turbo Exhaust Pressure (P11) are strong indicators of Ring Wear. Physically, this is consistent: worn rings allow gas to leak from the cylinder, reducing the energy available to the turbine.</li>
          </ul>
        </div>
        
        <div class="has-text-centered reveal delay-2">
            <img src="../static/images/fig11_shap.jpg" class="hover-card" alt="SHAP Analysis,including Waterfall plot, beeswarm plot, interaction plot and dependence plot" style="width:100%; border-radius: 10px;">
            <p class="subtitle is-6">
                <strong>Figure 11:</strong> Fault analysis of piston ring wear (F4) based on SHAP values: (a) Waterfall plot; (b) Beeswarm plot; (c) Interaction plot; (d) Dependence plot.
            </p>
        </div>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/xcode.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        
        <div class="reveal delay-2" style="margin-top: 2rem; margin-bottom: 2rem;">
          <details class="box hover-card" style="background-color: #fcfcfc; border: 1px solid #eee;">
            <summary class="title is-5 is-size-6-mobile" style="cursor: pointer; color: #363636; margin-bottom: 0;">
              <span class="icon has-text-info" style="margin-right: 0.5rem;">
                <i class="fas fa-code"></i>
              </span>
              <span>Click to view SHAP Visualization Code (Python)</span>
            </summary>
            
            <div class="content has-text-left" style="margin-top: 1.5rem;">
              <p>
                If you are interested in the implementation details of the figures above, here is the sample code used to generate the Waterfall, Beeswarm, Interaction, and Dependence plots.üëá
              </p>
              
              <pre style="padding: 0; border-radius: 8px; overflow: hidden;"><code class="language-python" style="border-radius: 8px; font-size: 0.85rem; line-height: 1.5;">import shap
import matplotlib.pyplot as plt
import numpy as np

# --- 0. Setup & Global Settings ---
plt.rcParams['font.family'] = 'Arial'
plt.rcParams['font.size'] = '24'
plt.rcParams['axes.unicode_minus'] = False

# Assumption: 'best_model' is your trained XGBoost/RF model
# Assumption: 'X_train' and 'X_test' are pandas DataFrames

# 1. Calculate SHAP values as Numpy Arrays (for Beeswarm, Dependence, Interaction)
explainer_tree = shap.TreeExplainer(best_model)
shap_values_numpy = explainer_tree.shap_values(X_train) 

# 2. Calculate SHAP values as Explanation Object (Specifically for Waterfall)
explainer_obj = shap.Explainer(best_model, X_test)
shap_values_obj = explainer_obj(X_test)


##################################################################
#                                                                #
#                      (a) Waterfall Plot                        #
#          Visualizes contribution for a single sample           #
#                                                                #
##################################################################

class_idx = 4  # Target class
sample_idx = 3 # Specific sample to explain

plt.figure()
shap.plots.waterfall(
    shap_values_obj[sample_idx, :, class_idx], 
    max_display=9, 
    show=False
)

# Customizing style
ax = plt.gca()
ax.set_xlabel(ax.get_xlabel(), fontsize=36)
ax.set_ylabel(ax.get_ylabel(), fontsize=36)
ax.spines['bottom'].set_linewidth(3)
plt.show()


##################################################################
#                                                                #
#                      (b) Beeswarm Plot                         #
#              Global summary of feature importance              #
#                                                                #
##################################################################

class_idx = 5
plt.figure(figsize=(10, 8))

shap.summary_plot(
    shap_values_numpy[..., class_idx], 
    X_train, 
    feature_names=X_train.columns, 
    plot_type="dot", 
    show=False, 
    cmap='Greys' # or 'plasma'
)

# Customize Color Bar
cbar = plt.gcf().axes[-1] 
cbar.set_ylabel('Parameter Value', fontsize=24)
cbar.tick_params(labelsize=20)
plt.show()


##################################################################
#                                                                #
#                     (c) Interaction Plot                       #
#          Visualizes interaction effects between features       #
#                                                                #
##################################################################

# Note: Calculation can be expensive
shap_interaction_values = explainer_tree.shap_interaction_values(X_test)
class_idx = 4

plt.figure()
shap.summary_plot(
    shap_interaction_values[..., class_idx], 
    X_test, 
    show=False, 
    max_display=6, 
    cmap='Greys' 
)

# Clean up subplots
axes = plt.gcf().axes
for ax in axes:
    ax.spines['bottom'].set_linewidth(2)
    ax.tick_params(axis="x", labelsize=18, width=2)
    ax.set_title(ax.get_title(), fontsize=14) 

plt.subplots_adjust(wspace=0.3, hspace=0.4)    
plt.show()


##################################################################
#                                                                #
#                     (d) Dependence Plot                        #
#           Feature relationship colored by interaction          #
#                                                                #
##################################################################

Feature_X = 'P06'  # Main feature
Feature_Y = 'P07'  # Interaction feature
class_idx = 4

shap.dependence_plot(
    Feature_X, 
    shap_values_numpy[..., class_idx], 
    X_train, 
    interaction_index=Feature_Y, 
    dot_size=100, 
    show=False
)

# Customize Axes
ax = plt.gca()
ax.tick_params(axis='both', which='major', labelsize=36, width=2)
ax.set_ylabel(f'SHAP value ({Feature_X})', fontsize=36)
ax.spines['bottom'].set_linewidth(3)
ax.spines['left'].set_linewidth(3)
plt.show()


##################################################################
#                                                                #
#            (e) Advanced Composite Plot (Beeswarm + Bar)        #
#      Combines Beeswarm (Bottom Axis) & Importance (Top Axis)   #
#                                                                #
##################################################################

class_idx = 5
fig, ax1 = plt.subplots(figsize=(10, 8))

# 1. Main Beeswarm Plot (on ax1)
shap.summary_plot(
    shap_values_numpy[..., class_idx], 
    X_train, 
    feature_names=X_train.columns, 
    plot_type="dot", 
    show=False, 
    color_bar=True, 
    cmap='Greys' # or 'plasma'
)

# Customize Color Bar
cbar = plt.gcf().axes[-1] 
cbar.set_ylabel('Parameter Value', fontsize=24)
cbar.tick_params(labelsize=20)

# Adjust layout to make room for the top axis
plt.gca().set_position([0.2, 0.2, 0.65, 0.65]) 

# 2. Feature Importance Bar Plot (on Top Axis ax2)
# Create a twin axis sharing the y-axis
ax2 = ax1.twiny() 

shap.summary_plot(
    shap_values_numpy[..., class_idx], 
    X_train, 
    plot_type="bar", 
    show=False
)

# Align position with the main plot
plt.gca().set_position([0.2, 0.2, 0.65, 0.65]) 

# Style the bars (Transparent & Light Color)
bars = ax2.patches
for bar in bars:
    bar.set_color('#CCE5FB') # Light blue background bars
    bar.set_alpha(0.4)       # Transparency

# Customize Axes Labels
ax1.set_xlabel(f'Shapley Value Contribution (F{class_idx})', fontsize=24, labelpad=5)
ax1.set_ylabel('Parameters', fontsize=24)
ax2.set_xlabel('Mean Shapley Value (Parameter Importance)', fontsize=24, labelpad=10)

# Move ax2 (Bar plot axis) to the top
ax2.xaxis.set_label_position('top') 
ax2.xaxis.tick_top()

# Ensure ax1 (dots) is drawn ON TOP OF ax2 (bars)
ax1.set_zorder(ax1.get_zorder() + 1) 
ax1.patch.set_visible(False) # Make ax1 background transparent

plt.show()</code></pre>
              
            </div>
          </details>
        </div>
              
      </div>
    </div>

    <hr>

    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3 reveal">Research Highlights</h2>
        <div class="content has-text-justified reveal delay-1">
          <p>
            We believe this work offers several key contributions to the field:
          </p>
          
           <ul class="highlight-list stagger-wrapper"> 
            <li class="stagger-item hover-card">
                <strong>Performs parameterized modeling of five faults in marine diesel engine combustion chamber.</strong>
            </li>
            <li class="stagger-item hover-card">
                <strong>Evaluated the effectiveness of SHAP method through comparison with multiple feature selection methods.</strong> 
            </li>
            <li class="stagger-item hover-card">
                <strong>A novel insight into interpretable fault diagnosis is provided by integrating data-driven method with thermodynamic model.</strong> 
            </li>
          </ul>
        </div>
      </div>
    </div>

  </div>
</section>

<section class="section reveal" id="BibTeX" style="padding-top: 0; margin-top: -2rem;">
  <div class="container is-max-desktop content">
    
    <hr>

    <h2 class="title">Citation</h2>
    
    <div class="citation-prompt">
      <span class="icon is-small" style="margin-right: 0.5rem; color: #3273dc;">
        <i class="fas fa-quote-left"></i>
      </span>
      If you find this work useful for your research, please consider citing üòä
    </div>

    <h4 class="title is-5 is-size-6-mobile" style="margin-bottom: 0.5rem; color: #666;">BibTeX</h4>
    
    <pre style="margin-bottom: 5px; background-color: #fcfcfc; border: 1px solid #e5e5e5; border-radius: 8px; padding: 1.25rem;"><code id="bibtex-source" class="language-latex" style="font-family: 'Times New Roman', Times, serif !important; font-size: 16px; line-height: 1.5;">@article{luo2025thermodynamic,
  title     = {Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines},
  author    = {Luo, Congcong and Zhao, Minghang and Fu, Xuyun and Zhong, Shisheng and Fu, Song and Zhang, Kai and Yu, Xiaoxia},
  journal   = {Measurement},
  volume    = {251},
  pages     = {117252},
  year      = {2025},
  publisher = {Elsevier},
  doi       = {10.1016/j.measurement.2025.117252},
}</code></pre>
    
    <div class="level is-mobile" style="margin-top: 10px; margin-bottom: 2rem;">
      <div class="level-left">
        <button class="button is-dark is-small is-rounded" onclick="copyText('bibtex-source', this)">
          <span class="icon is-small">
            <i class="fas fa-copy"></i>
          </span>
          <span class="btn-text">Copy BibTeX</span>
        </button>
      </div>
    </div>

    <h4 class="title is-5 is-size-6-mobile" style="margin-bottom: 0.5rem; color: #666;">Standard Format</h4>
    
    <div class="box" style="background-color: #fcfcfc; border: 1px solid #e5e5e5; padding: 1.25rem; margin-bottom: 5px;">
      <p id="standard-citation" style="margin-bottom: 0; font-family: 'Times New Roman', Times, serif; font-size: 16px; line-height: 1.5;">
        C. Luo, M. Zhao, X. Fu, S. Zhong, S. Fu, K. Zhang, X. Yu. Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines[J]. Measurement, 2025, 251: 117252.
      </p>
    </div>

    <div class="level is-mobile" style="margin-top: 10px;">
      <div class="level-left">
        <button class="button is-dark is-small is-rounded" onclick="copyText('standard-citation', this)">
          <span class="icon is-small">
            <i class="fas fa-copy"></i>
          </span>
          <span class="btn-text">Copy Text</span>
        </button>
        
        <a href="https://www.sciencedirect.com/science/article/pii/S0263224125006116" target="_blank" class="button is-text is-small" style="text-decoration: none; margin-left: 10px;">
          <span class="icon has-text-info">
            <i class="fas fa-external-link-alt"></i>
          </span>
          <span>View on ScienceDirect</span>
        </a>
      </div>
    </div>

  </div>
</section>

<style>
  .citation-prompt {
    background-color: #f5f5f5;
    border-left: 5px solid #3273dc;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    border-radius: 4px;
    font-size: 1.1rem;
    color: #4a4a4a;
    font-weight: 500;
  }
  /* Á°Æ‰øù pre Ê†áÁ≠æ‰∏ç‰ºöÂõ†‰∏∫Ê°ÜÊû∂Ê†∑ÂºèÂπ≤Êâ∞ padding */
  pre {
      padding: 1.25rem !important;
  }
</style>

<script>
  function copyText(elementId, btn) {
    const textToCopy = document.getElementById(elementId).innerText;
    navigator.clipboard.writeText(textToCopy).then(() => {
      const icon = btn.querySelector('.fa-copy');
      const text = btn.querySelector('.btn-text');
      const originalText = text.innerText;
      
      if(icon) {
        icon.classList.remove('fa-copy');
        icon.classList.add('fa-check');
      }
      if(text) text.innerText = "Copied!";
      
      btn.classList.remove('is-dark');
      btn.classList.add('is-success');
      
      setTimeout(() => {
        if(icon) {
          icon.classList.remove('fa-check');
          icon.classList.add('fa-copy');
        }
        if(text) text.innerText = originalText;
        btn.classList.remove('is-success');
        btn.classList.add('is-dark');
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }
</script>

<footer class="footer">
  <div class="container">
    
    <div class="content has-text-centered">
      <a class="icon-link" href="https://doi.org/10.1016/j.measurement.2025.117252">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="#" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>

    <div class="columns is-centered is-vcentered">
      
      <div class="column is-6">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            Copyright ¬© 2025 Congcong Luo et al. Published in <a href="https://doi.org/10.1016/j.measurement.2025.117252" target="_blank">Measurement</a>.
          </p>
          <p>
            This website is adapted from the <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a> project page template.
          </p>
          <p style="margin-top: 10px; font-size: 0.9rem;">
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            
            <span id="busuanzi_container_site_uv" style="display:none">
              Number of visitors: <span id="busuanzi_value_site_uv" style="font-weight: bold;"></span> 
            </span>
            <span style="margin: 0 8px; color: #ccc;">|</span>
            <span id="busuanzi_container_site_pv" style="display:none">
              Total Visits: <span id="busuanzi_value_site_pv" style="font-weight: bold;"></span> 
            </span>
          </p>
        </div>
      </div>

      <div class="column is-2">
        <div style="width: 100%; max-width: 200px; margin: 0 auto 0 0;">
          <script type="text/javascript" id="clstr_globe" src="//clustrmaps.com/globe.js?d=_zkZv1bfxiqAq8HXllAuUZNIvCYv603-zyA7z-Vpjfw"></script>
        </div>
      </div>

    </div>
    </div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
                
            }
        });
    }, {
        threshold: 0.1 
    });
  
    // ÁõëÂê¨ reveal Á±ªÂíå stagger-wrapper Á±ª
    document.querySelectorAll('.reveal, .stagger-wrapper').forEach(el => {
        observer.observe(el);
    });
});
</script>

</body>
</html>
