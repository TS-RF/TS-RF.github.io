<!DOCTYPE html>
<html lang="vi">
 <head>
  <link href="https://ts-rf.github.io/" hreflang="en" rel="alternate"/>
  <link href="https://ts-rf.github.io/zh/" hreflang="zh-CN" rel="alternate"/>
  <link href="https://ts-rf.github.io/" hreflang="x-default" rel="alternate"/>
  <meta content="TSRF: Nghi√™n c·ª©u ch·∫©n ƒëo√°n l·ªói c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c cho ƒë·ªông c∆° diesel h√†ng h·∫£i" property="og:title"/>
  <meta content="K·∫øt h·ª£p m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc v√† thu·∫≠t to√°n R·ª´ng ng·∫´u nhi√™n (Random Forest), ƒë·ªÅ xu·∫•t m·ªôt ph∆∞∆°ng ph√°p h·ªçc m√°y th√¥ng tin v·∫≠t l√Ω (PIML) v√† AI c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c ƒë·ªÉ qu·∫£n l√Ω s·ª©c kh·ªèe ƒë·ªông c∆° h√†ng h·∫£i." property="og:description"/>
  <meta content="https://ts-rf.github.io/static/images/fig1_structure.jpg" property="og:image"/>
  <meta content="https://ts-rf.github.io/" property="og:url"/>
  <meta content="website" property="og:type"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta charset="utf-8"/>
  <meta content="K·∫øt h·ª£p m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc v√† thu·∫≠t to√°n R·ª´ng ng·∫´u nhi√™n (Random Forest), ƒë·ªÅ xu·∫•t m·ªôt ph∆∞∆°ng ph√°p h·ªçc m√°y th√¥ng tin v·∫≠t l√Ω (PIML) v√† AI c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c ƒë·ªÉ qu·∫£n l√Ω s·ª©c kh·ªèe ƒë·ªông c∆° h√†ng h·∫£i." name="description"/>
  <meta content="ƒê·ªông c∆° diesel h√†ng h·∫£i, Ch·∫©n ƒëo√°n l·ªói, R·ª´ng ng·∫´u nhi√™n, SHAP, AI c√≥ th·ªÉ gi·∫£i th√≠ch, H·ªçc m√°y th√¥ng tin v·∫≠t l√Ω, PIML, M√¥ h√¨nh c∆° ch·∫ø, T·∫°o d·ªØ li·ªáu t·ªïng h·ª£p, B·∫£o tr√¨ d·ª± ƒëo√°n, M√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc, AVL BOOST" name="keywords"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   TSRF: Nghi√™n c·ª©u ch·∫©n ƒëo√°n l·ªói c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c cho ƒë·ªông c∆° diesel h√†ng h·∫£i
  </title>
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>
  <script>
   window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet"/>
  <link href="../static/css/bulma.min.css" rel="stylesheet"/>
  <link href="../static/css/bulma-carousel.min.css" rel="stylesheet"/>
  <link href="../static/css/bulma-slider.min.css" rel="stylesheet"/>
  <link href="../static/css/fontawesome.all.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" rel="stylesheet"/>
  <link href="../static/css/index.css" rel="stylesheet"/>
  <link href="../static/images/favicon.svg" rel="icon"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
  </script>
  <script defer="" src="../static/js/fontawesome.all.min.js">
  </script>
  <script src="../static/js/bulma-carousel.min.js">
  </script>
  <script src="../static/js/bulma-slider.min.js">
  </script>
  <script src="../static/js/index.js">
  </script>
  <style>
   .keyword-label {
      font-weight: bold;
      margin-right: 10px;
      vertical-align: middle;
      color: #363636;
    }

    .tags .tag {
      transition: all 0.2s ease;
      font-size: 0.9rem;
    }

    .tags .tag:hover {
      background-color: #3273dc;
      color: #fff;
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(50, 115, 220, 0.2);
    }

    /* Ê†∏ÂøÉÂä®ÁîªÁ±ª */
    .reveal {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .reveal.active {
      opacity: 1;
      transform: translateY(0);
    }

    /* ÁÆÄÂçïÁöÑÂª∂ËøüÁ±ª */
    .reveal.delay-1 { transition-delay: 0.1s; }
    .reveal.delay-2 { transition-delay: 0.2s; }
    .reveal.delay-3 { transition-delay: 0.3s; }

    .hover-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      will-change: transform;
    }

    .hover-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px -10px rgba(0,0,0,0.2);
    }

    .highlight-list li {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border-left: 4px solid #3273dc;
    }

    .stagger-wrapper .stagger-item {
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.6s ease-out;
    }

    .stagger-wrapper.active .stagger-item {
      opacity: 1;
      transform: translateX(0);
    }

    .stagger-wrapper.active .stagger-item:nth-child(1) { transition-delay: 0.1s; }
    .stagger-wrapper.active .stagger-item:nth-child(2) { transition-delay: 0.3s; }
    .stagger-wrapper.active .stagger-item:nth-child(3) { transition-delay: 0.5s; }
  </style>
  <script type="application/ld+json">
   {
  "@context": "https://schema.org",
  "@type": "ScholarlyArticle",
  "headline": "R·ª´ng ng·∫´u nhi√™n h·ªó tr·ª£ b·ªüi m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc: Ch·∫©n ƒëo√°n l·ªói c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c cho c√°c b·ªô ph·∫≠n bu·ªìng ƒë·ªët ƒë·ªông c∆° diesel h√†ng h·∫£i",
  "image": [
    "https://ts-rf.github.io/static/images/fig1_structure.jpg"
  ],
  "datePublished": "2025-01-01",
  "author": [
    {
      "@type": "Person",
      "name": "Congcong Luo"
    },
    {
      "@type": "Person",
      "name": "Minghang Zhao"
    },
    {
      "@type": "Person",
      "name": "Xuyun Fu"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Elsevier Measurement"
  },
  "description": "M·ªôt ph∆∞∆°ng ph√°p h·ªçc m√°y th√¥ng tin v·∫≠t l√Ω k·∫øt h·ª£p m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc v√† SHAP ƒë·ªÉ ch·∫©n ƒëo√°n l·ªói ƒë·ªông c∆° diesel h√†ng h·∫£i."
}
  </script>
 </head>
 <body>
  <nav aria-label="main navigation" class="navbar" role="navigation">
   <div class="navbar-brand">
    <a aria-expanded="false" aria-label="menu" class="navbar-burger" role="button">
     <span aria-hidden="true">
     </span>
     <span aria-hidden="true">
     </span>
     <span aria-hidden="true">
     </span>
    </a>
   </div>
   <div class="navbar-menu">
    <div class="navbar-start">
    </div>
    <a class="navbar-item navbar-absolute-center" href="https://scholar.google.com/citations?hl=zh-CN&amp;user=k82TzLwAAAAJ" target="_blank">
     <span class="icon" style="margin-right: 0.3rem;">
      <img alt="Google Scholar" src="https://upload.wikimedia.org/wikipedia/commons/c/c7/Google_Scholar_logo.svg" style="height: 20px; width: 20px;"/>
     </span>
     <span>
      Minghang Zhao (Google Scholar)
     </span>
    </a>
    <div class="navbar-end">
     <div class="navbar-item has-dropdown is-hoverable">
      <a class="navbar-link">
       <span class="icon">
        <i class="fas fa-globe">
        </i>
       </span>
       <span>
        Ng√¥n ng·ªØ
       </span>
      </a>
      <div class="navbar-dropdown is-right" style="max-height: 500px; overflow-y: auto;">
       <a class="navbar-item" href="https://ts-rf.github.io/">
        English
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/zh-CN/">
        ÁÆÄ‰Ωì‰∏≠Êñá
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/zh-TW/">
        ÁπÅÈ´î‰∏≠Êñá
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/hi/">
        ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/es/">
        Espa√±ol
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/fr/">
        Fran√ßais
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/ar/">
        ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/pt/">
        Portugu√™s
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/ru/">
        –†—É—Å—Å–∫–∏–π
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/id/">
        Indonesia
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/de/">
        Deutsch
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/ja/">
        Êó•Êú¨Ë™û
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/tr/">
        T√ºrk√ße
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/vi/">
        Ti·∫øng Vi·ªát
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/ko/">
        ÌïúÍµ≠Ïñ¥
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/fa/">
        ŸÅÿßÿ±ÿ≥€å
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/it/">
        Italiano
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/th/">
        ‡πÑ‡∏ó‡∏¢
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/pl/">
        Polski
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/uk/">
        –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/ro/">
        Rom√¢nƒÉ
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/nl/">
        Nederlands
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/sv/">
        Svenska
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/cs/">
        ƒåe≈°tina
       </a>
       <a class="navbar-item" href="https://ts-rf.github.io/he/">
        ◊¢◊ë◊®◊ô◊™
       </a>
      </div>
     </div>
    </div>
   </div>
  </nav>
  <section class="hero reveal">
   <div class="hero-body" style="padding-top: 1rem;">
    <div class="container is-max-desktop">
     <div class="columns is-centered">
      <div class="column has-text-centered">
       <h1 class="title is-1 publication-title">
        R·ª´ng ng·∫´u nhi√™n h·ªó tr·ª£ b·ªüi m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc: Ch·∫©n ƒëo√°n l·ªói c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c cho c√°c b·ªô ph·∫≠n bu·ªìng ƒë·ªët ƒë·ªông c∆° diesel h√†ng h·∫£i
       </h1>
       <div class="is-size-5 publication-authors">
        <span class="author-block">
         <strong>
          Congcong Luo
         </strong>
         <sup>
          a
         </sup>
         ,
        </span>
        <span class="author-block">
         <a href="https://homepage.hit.edu.cn/zhaominghang?lang=en" style="color: inherit; text-decoration: underline;" target="_blank">
          <strong>
           Minghang Zhao
          </strong>
         </a>
         <sup>
          a,*
         </sup>
         ,
        </span>
        <span class="author-block">
         <strong>
          Xuyun Fu
         </strong>
         <sup>
          a
         </sup>
         ,
        </span>
        <span class="author-block">
         <strong>
          Shisheng Zhong
         </strong>
         <sup>
          a
         </sup>
         ,
        </span>
        <span class="author-block">
         <strong>
          Song Fu
         </strong>
         <sup>
          b
         </sup>
         ,
        </span>
        <span class="author-block">
         <strong>
          Kai Zhang
         </strong>
         <sup>
          c
         </sup>
         ,
        </span>
        <span class="author-block">
         <strong>
          Xiaoxia Yu
         </strong>
         <sup>
          d
         </sup>
        </span>
       </div>
       <div class="is-size-6 publication-authors" style="font-size: 0.8rem; line-height: 1.5;">
        <span class="author-block">
         <sup>
          a
         </sup>
         Department of Mechanical Engineering, Harbin Institute of Technology, Weihai, Weihai 264209, China
        </span>
        <br/>
        <span class="author-block">
         <sup>
          b
         </sup>
         School of Mechatronics Engineering, Harbin Institute of Technology, Harbin 150001, China
        </span>
        <br/>
        <span class="author-block">
         <sup>
          c
         </sup>
         School of Mechanical Engineering, Southwest Jiaotong University, Chengdu 610031, China
        </span>
        <br/>
        <span class="author-block">
         <sup>
          d
         </sup>
         School of Mechanical Engineering, Chongqing University of Technology, Chongqing 400054, China
        </span>
       </div>
       <div class="column has-text-centered">
        <div class="publication-links">
         <span class="link-block">
          <a class="button is-normal is-rounded is-dark hover-card" href="../TSRF.pdf" target="_blank">
           <span class="icon">
            <i class="fas fa-file-pdf">
            </i>
           </span>
           <span>
            To√†n vƒÉn b√†i b√°o
           </span>
          </a>
         </span>
         <span class="link-block">
          <a class="button is-normal is-rounded is-dark hover-card" href="https://github.com/TS-RF/TSRF" target="_blank">
           <span class="icon">
            <i class="fab fa-github">
            </i>
           </span>
           <span>
            M√£ ngu·ªìn
           </span>
          </a>
         </span>
         <span class="link-block">
          <a class="button is-normal is-rounded is-dark hover-card" href="https://github.com/TS-RF/TSRF/releases/tag/dataset" target="_blank">
           <span class="icon">
            <i class="fas fa-file-csv">
            </i>
           </span>
           <span>
            B·ªô d·ªØ li·ªáu
           </span>
          </a>
         </span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </section>
  <section class="section" style="padding-top: 0rem; margin-top: 0rem;">
   <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
     <div class="column is-four-fifths">
      <h2 class="title is-3 reveal">
       T√≥m t·∫Øt
      </h2>
      <div class="content has-text-justified reveal delay-1">
       <p>
        C√°c ph∆∞∆°ng ph√°p ch·∫©n ƒëo√°n l·ªói th√¥ng minh truy·ªÅn th·ªëng cho ƒë·ªông c∆° diesel h√†ng h·∫£i th∆∞·ªùng c√≥ kh·∫£ nƒÉng kh√°i qu√°t h√≥a k√©m do thi·∫øu m·∫´u hu·∫•n luy·ªán v·ªÅ l·ªói, v√† kh·∫£ nƒÉng gi·∫£i th√≠ch th·∫•p do ch∆∞a t√≠ch h·ª£p ƒë·∫ßy ƒë·ªß ki·∫øn th·ª©c ti√™n nghi·ªám v·ªÅ c∆° ch·∫ø h∆∞ h·ªèng. ƒê·ªÉ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ tr√™n, b√†i b√°o n√†y ƒë·ªÅ xu·∫•t ph∆∞∆°ng ph√°p
        <strong>
         R·ª´ng ng·∫´u nhi√™n h·ªó tr·ª£ b·ªüi m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc (TSRF)
        </strong>
        .
       </p>
       <p>
        Ph∆∞∆°ng ph√°p n√†y l√†m s√°ng t·ªè c√°c ƒë·∫∑c ƒëi·ªÉm di·ªÖn bi·∫øn l·ªói th√¥ng qua m√¥ ph·ªèng nhi·ªát ƒë·ªông l·ª±c h·ªçc v√† t√≠ch h·ª£p ch√∫ng l√†m ki·∫øn th·ª©c ti√™n nghi·ªám trong thi·∫øt k·∫ø m√¥ h√¨nh ch·∫©n ƒëo√°n l·ªói th√¥ng minh. ƒê·∫ßu ti√™n, nƒÉm m√¥ h√¨nh l·ªói nhi·ªát ƒë·ªông l·ª±c h·ªçc ƒë√£ ƒë∆∞·ª£c ph√°t tri·ªÉn b·∫±ng c√°ch tinh ch·ªânh c√°c th√¥ng s·ªë c∆° b·∫£n c·ªßa h·ªá th·ªëng ƒë·ªÉ m√¥ ph·ªèng c√°c ƒë·∫∑c ƒëi·ªÉm quan tr·ªçng c·ªßa c√°c s·ª± c·ªë kh√°c nhau. Sau ƒë√≥, d·ª±a tr√™n k·∫øt qu·∫£ m√¥ ph·ªèng s·ªë, c√°c ch·ªâ s·ªë nhi·ªát ƒë·ªông l·ª±c h·ªçc ti·ªÅm nƒÉng ƒë·∫∑c tr∆∞ng cho s·ª± suy gi·∫£m c·ªßa c√°c b·ªô ph·∫≠n bu·ªìng ƒë·ªët ƒë√£ ƒë∆∞·ª£c x√°c ƒë·ªãnh.
       </p>
       <p>
        Vi·ªác l·ª±a ch·ªçn ƒë·∫∑c tr∆∞ng ƒë∆∞·ª£c th·ª±c hi·ªán b·∫±ng c√°ch t√≠nh to√°n c√°c gi√° tr·ªã SHapley Additive exPlanations (SHAP), ch·ªâ gi·ªØ l·∫°i c√°c bi·∫øn c√≥ m·ªëi t∆∞∆°ng quan ƒë√°ng k·ªÉ v·ªõi tr·∫°ng th√°i l·ªói. Cu·ªëi c√πng, tr·∫°ng th√°i s·ª©c kh·ªèe c·ªßa bu·ªìng ƒë·ªët ƒë∆∞·ª£c ƒë√°nh gi√° b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c th√¥ng s·ªë ƒë√£ ch·ªçn. K·∫øt qu·∫£ th·ª±c nghi·ªám cho th·∫•y ph∆∞∆°ng ph√°p TSRF ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t th·ªÉ hi·ªán hi·ªáu su·∫•t ph√¢n lo·∫°i xu·∫•t s·∫Øc, v·ªõi ƒë·ªô ch√≠nh x√°c trung b√¨nh ƒë·∫°t 99,07% tr√™n b·ªô d·ªØ li·ªáu l·ªói.
       </p>
       <div class="keywords-container" style="margin-top: 2rem;">
        <span class="keyword-label">
         T·ª´ kh√≥a:
        </span>
        <div class="tags is-inline-block">
         <span class="tag is-light is-info">
          ƒê·ªông c∆° diesel h√†ng h·∫£i
         </span>
         <span class="tag is-light is-info">
          Ch·∫©n ƒëo√°n l·ªói
         </span>
         <span class="tag is-light is-info">
          AI c√≥ th·ªÉ gi·∫£i th√≠ch
         </span>
         <span class="tag is-light is-info">
          Gi√° tr·ªã SHAP
         </span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </section>
  <section class="section" style="padding-top: 1rem; margin-top: 1rem;">
   <div class="container is-max-desktop">
    <div class="columns is-centered">
     <div class="column is-full-width">
      <h2 class="title is-3 reveal">
       ƒê·ªông l·ª±c nghi√™n c·ª©u
      </h2>
      <div class="content has-text-justified reveal delay-1">
       <p>
        Trong lƒ©nh v·ª±c k·ªπ thu·∫≠t h√†ng h·∫£i v√† Qu·∫£n l√Ω ti√™n l∆∞·ª£ng &amp; s·ª©c kh·ªèe (PHM), ng√†nh c√¥ng nghi·ªáp ƒëang ph·∫£i ƒë·ªëi m·∫∑t v·ªõi hai n√∫t th·∫Øt l√¢u d√†i:
       </p>
       <ul>
        <li>
         <strong>
          Khan hi·∫øm d·ªØ li·ªáu:
         </strong>
         ƒê·ªông c∆° diesel h√†ng h·∫£i (ƒë·∫∑c bi·ªát l√† ƒë·ªông c∆° ch√≠nh c·ªßa t√†u vi·ªÖn d∆∞∆°ng) l√† tr√°i tim c·ªßa con t√†u. M·ªôt s·ª± c·ªë nghi√™m tr·ªçng tr√™n bi·ªÉn c√≥ th·ªÉ d·∫´n ƒë·∫øn m·∫•t ƒë·ªông l·ª±c, m·∫Øc c·∫°n ho·∫∑c th·∫≠m ch√≠ l√† th·∫£m h·ªça. Do ƒë√≥, h·ªá s·ªë an to√†n trong thi·∫øt k·∫ø c·ªßa ch√∫ng c·ª±c k·ª≥ cao v√† x√°c su·∫•t x·∫£y ra l·ªói nghi√™m tr·ªçng v·ªÅ b·∫£n ch·∫•t l√† r·∫•t th·∫•p. Ngo√†i ra, ng√†nh h√†ng h·∫£i th·ª±c hi·ªán c√°c h·ªá th·ªëng b·∫£o tr√¨ ph√≤ng ng·ª´a nghi√™m ng·∫∑t (nh∆∞ ƒë·∫°i tu ƒë·ªãnh k·ª≥ d·ª±a tr√™n gi·ªù ho·∫°t ƒë·ªông). Ph·∫ßn l·ªõn c√°c b·ªô ph·∫≠n hao m√≤n b·ªã thay th·∫ø b·∫Øt bu·ªôc tr∆∞·ªõc khi ch√∫ng th·ª±c s·ª± h·ªèng h√≥c v√† t·∫°o ra d·ªØ li·ªáu l·ªói. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn s·ª± phong ph√∫ c·ªßa d·ªØ li·ªáu s·ª©c kh·ªèe v√† d·ªØ li·ªáu m√†i m√≤n s·ªõm, nh∆∞ng l·∫°i c·ª±c k·ª≥ thi·∫øu d·ªØ li·ªáu th·ª±c t·∫ø v·ªÅ c√°c h∆∞ h·ªèng ho√†n to√†n ho·∫∑c s·ª± c·ªë nghi√™m tr·ªçng.
        </li>
        <li>
         <strong>
          V·∫•n ƒë·ªÅ "H·ªôp ƒëen":
         </strong>
         Do c√°c m√¥ h√¨nh h·ªçc s√¢u th∆∞·ªùng thi·∫øu t√≠nh minh b·∫°ch, c√°c k·ªπ s∆∞ r·∫•t kh√≥ tin t∆∞·ªüng v√†o ch√∫ng n·∫øu kh√¥ng th·ªÉ gi·∫£i th√≠ch nguy√™n nh√¢n v·∫≠t l√Ω c·ªßa s·ª± c·ªë. Trong ng√†nh v·∫≠n t·∫£i bi·ªÉn, n∆°i ƒë∆∞·ª£c qu·∫£n l√Ω ch·∫∑t ch·∫Ω b·ªüi c√°c t·ªï ch·ª©c ƒëƒÉng ki·ªÉm, s·ª± thi·∫øu minh b·∫°ch n√†y l√† r·∫•t quan tr·ªçng. N·∫øu AI ch·∫©n ƒëo√°n sai (ho·∫∑c b·ªè s√≥t) hi·ªán t∆∞·ª£ng b√≥ k·∫πt piston ho·∫∑c g√£y tr·ª•c khu·ª∑u, v√† h·ªá th·ªëng kh√¥ng th·ªÉ truy xu·∫•t xem l·ªói b·∫Øt ngu·ªìn t·ª´ sai l·ªách d·ªØ li·ªáu, khi·∫øm khuy·∫øt thu·∫≠t to√°n hay tr√¥i c·∫£m bi·∫øn, th√¨ s·ª± kh√¥ng th·ªÉ truy xu·∫•t n√†y l√† kh√¥ng th·ªÉ ch·∫•p nh·∫≠n ƒë∆∞·ª£c trong c√°c cu·ªôc ƒëi·ªÅu tra tai n·∫°n h√†ng h·∫£i.
        </li>
       </ul>
       <p>
        ƒê·ªÉ gi·∫£i quy·∫øt nh·ªØng th√°ch th·ª©c n√†y, ch√∫ng t√¥i ƒë√£ ƒë·ªÅ xu·∫•t ph∆∞∆°ng ph√°p TSRF. B·∫±ng c√°ch k·∫øt h·ª£p c√°c m√¥ h√¨nh c∆° ch·∫ø d·ª±a tr√™n v·∫≠t l√Ω v·ªõi c√°c k·ªπ thu·∫≠t gi·∫£i th√≠ch ti√™n ti·∫øn v√† s·ª≠ d·ª•ng c√°c m√¥ h√¨nh m√¥ ph·ªèng ƒë·ªô trung th·ª±c cao ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ khan hi·∫øm d·ªØ li·ªáu, ch√∫ng t√¥i ƒë·∫£m b·∫£o r·∫±ng c√°c quy·∫øt ƒë·ªãnh ch·∫©n ƒëo√°n tu√¢n th·ªß c√°c nguy√™n l√Ω nhi·ªát ƒë·ªông l·ª±c h·ªçc c∆° b·∫£n.
       </p>
      </div>
     </div>
    </div>
    <hr/>
    <div class="columns is-centered">
     <div class="column is-full-width">
      <h2 class="title is-3 reveal">
       Ph∆∞∆°ng ph√°p lu·∫≠n
      </h2>
      <div class="content has-text-justified reveal delay-1">
       <p>
        Quy tr√¨nh l√†m vi·ªác c·ªßa nghi√™n c·ª©u n√†y bao g·ªìm b·ªën giai ƒëo·∫°n ch√≠nh sau ƒë√¢y (nh∆∞ h√¨nh minh h·ªça):
       </p>
       <ol>
        <li>
         <strong>
          M√¥ h√¨nh h√≥a nhi·ªát ƒë·ªông l·ª±c h·ªçc:
         </strong>
         Thay v√¨ ch·ªâ d·ª±a v√†o c√°c b·ªá th·ª≠ v·∫≠t l√Ω, ch√∫ng t√¥i ƒë√£ x√¢y d·ª±ng m·ªôt m√¥ h√¨nh nhi·ªát ƒë·ªông l·ª±c h·ªçc m·ªôt chi·ªÅu ƒë·ªô trung th·ª±c cao c·ªßa ƒë·ªông c∆° diesel h√†ng h·∫£i s√°u xi-lanh. M√¥ h√¨nh n√†y ƒë∆∞·ª£c hi·ªáu ch·ªânh nghi√™m ng·∫∑t d·ª±a tr√™n d·ªØ li·ªáu v·∫≠n h√†nh th·ª±c t·∫ø, v·ªõi sai s·ªë m√¥ ph·ªèng ƒë∆∞·ª£c ki·ªÉm so√°t d∆∞·ªõi 5%.
        </li>
        <li>
         <strong>
          Ti√™m l·ªói (Fault Injection):
         </strong>
         D·ª±a tr√™n m√¥ h√¨nh ƒë√£ hi·ªáu ch·ªânh, ch√∫ng t√¥i ƒë√£ m√¥ ph·ªèng nƒÉm l·ªói c·ª• th·ªÉ c·ªßa bu·ªìng ƒë·ªët (nh∆∞ n·ª©t n·∫Øp quy l√°t, ƒÉn m√≤n piston, v.v.) b·∫±ng c√°ch tinh ch·ªânh c√°c th√¥ng s·ªë v·∫≠t l√Ω, t·ª´ ƒë√≥ t·∫°o ra m·ªôt b·ªô d·ªØ li·ªáu bao g·ªìm c√°c m·ª©c ƒë·ªô l·ªói th·ª±c t·∫ø kh√°c nhau c·ªßa ƒë·ªông c∆°.
        </li>
        <li>
         <strong>
          L·ª±a ch·ªçn ƒë·∫∑c tr∆∞ng d·ª±a tr√™n SHAP:
         </strong>
         Ch√∫ng t√¥i s·ª≠ d·ª•ng c√°c gi√° tr·ªã SHAP ƒë·ªÉ x√°c ƒë·ªãnh ƒë·ªãnh l∆∞·ª£ng c√°c ƒë·∫∑c tr∆∞ng ch√≠nh, ch·ªçn ra 14 th√¥ng s·ªë quan tr·ªçng chi ph·ªëi quy·∫øt ƒë·ªãnh ch·∫©n ƒëo√°n.
        </li>
        <li>
         <strong>
          Ch·∫©n ƒëo√°n ph√¢n lo·∫°i:
         </strong>
         S·ª≠ d·ª•ng b·ªô d·ªØ li·ªáu ƒë∆∞·ª£c tƒÉng c∆∞·ªùng v·ªÅ m·∫∑t v·∫≠t l√Ω n√†y, ch√∫ng t√¥i ƒë√£ hu·∫•n luy·ªán m·ªôt b·ªô ph√¢n lo·∫°i R·ª´ng ng·∫´u nhi√™n (RF) v√† ƒë·∫°t ƒë∆∞·ª£c ch·∫©n ƒëo√°n l·ªói v·ªõi ƒë·ªô ch√≠nh x√°c cao.
        </li>
       </ol>
      </div>
      <div class="has-text-centered reveal delay-2">
       <img alt="Structure of TSRF method combining Thermodynamic Simulation and Random Forest for Explainable AI" class="hover-card" src="../static/images/fig1_structure.jpg" style="width:100%; height:auto; border-radius: 10px;"/>
       <p class="subtitle is-6">
        <strong>
         H√¨nh 1:
        </strong>
        Ki·∫øn tr√∫c ph∆∞∆°ng ph√°p TSRF.
       </p>
      </div>
     </div>
    </div>
    <hr/>
    <div class="columns is-centered">
     <div class="column is-full-width">
      <h2 class="title is-3 reveal">
       Chi ti·∫øt m√¥ h√¨nh h√≥a nhi·ªát ƒë·ªông l·ª±c h·ªçc
      </h2>
      <div class="content has-text-justified reveal delay-1">
       <p>
        ƒê·ªÉ ƒë·∫£m b·∫£o ƒë·ªô trung th·ª±c cao, ch√∫ng t√¥i ƒë√£ x√¢y d·ª±ng m√¥ h√¨nh m√¥ ph·ªèng ƒë·ªông c∆° diesel m·ªôt chi·ªÅu. M√¥ h√¨nh c∆° ch·∫ø n√†y c√¢n b·∫±ng gi·ªØa ƒë·ªô ch√≠nh x√°c v·∫≠t l√Ω v√† hi·ªáu qu·∫£ t√≠nh to√°n c·∫ßn thi·∫øt cho vi·ªác t·∫°o b·ªô d·ªØ li·ªáu.
       </p>
      </div>
      <div class="columns is-centered">
       <div class="column is-6 reveal delay-2">
        <div class="box hover-card" style="height: 100%;">
         <h4 class="title is-4 is-size-5">
          <span class="icon has-text-info" style="margin-right: 8px;">
           <i class="fas fa-network-wired">
           </i>
          </span>
          C·∫•u tr√∫c m√¥ h√¨nh
         </h4>
         <div class="content is-size-6">
          <p>
           H·ªá th·ªëng ƒë·ªông c∆° ƒë∆∞·ª£c r·ªùi r·∫°c h√≥a th√†nh m·∫°ng l∆∞·ªõi c√°c ƒë∆∞·ªùng ·ªëng l∆∞u ch·∫•t v√† c√°c th√†nh ph·∫ßn ch·ª©c nƒÉng:
          </p>
          <ul>
           <li>
            <strong>
             ƒê∆°n v·ªã ƒë·ªông l·ª±c c·ªët l√µi:
            </strong>
            C·∫•u h√¨nh s√°u xi-lanh, hai k·ª≥ th·∫≥ng h√†ng.
           </li>
           <li>
            <strong>
             H·ªá th·ªëng ƒë∆∞·ªùng kh√≠:
            </strong>
            ·ªêng g√≥p n·∫°p/x·∫£ (PL1, PL2) ƒë∆∞·ª£c k·∫øt n·ªëi th√¥ng qua m·∫°ng l∆∞·ªõi ƒë∆∞·ªùng ·ªëng ph·ª©c t·∫°p.
           </li>
           <li>
            <strong>
             H·ªá th·ªëng tƒÉng √°p:
            </strong>
            Tuabin tƒÉng √°p (TC1) k·∫øt h·ª£p v·ªõi b·ªô l√†m m√°t kh√≠ n·∫°p (CO1).
           </li>
          </ul>
         </div>
        </div>
       </div>
       <div class="column is-6 reveal delay-3">
        <div class="box hover-card" style="height: 100%;">
         <h4 class="title is-4 is-size-5">
          <span class="icon has-text-success" style="margin-right: 8px;">
           <i class="fas fa-check-double">
           </i>
          </span>
          Hi·ªáu ch·ªânh v√† x√°c nh·∫≠n
         </h4>
         <div class="content is-size-6">
          <p>
           Tr∆∞·ªõc khi th·ª±c hi·ªán ti√™m l·ªói, m√¥ h√¨nh c∆° s·ªü ƒë√£ ƒë∆∞·ª£c hi·ªáu ch·ªânh nghi√™m ng·∫∑t d·ª±a tr√™n d·ªØ li·ªáu ƒëo ƒë·∫°c.
          </p>
          <ul>
           <li>
            <strong>
             Ngu·ªìn d·ªØ li·ªáu:
            </strong>
            D·ªØ li·ªáu v·∫≠n h√†nh t√†u th·ª±c t·∫ø thu ƒë∆∞·ª£c th√¥ng qua M√¥ ƒëun Thu th·∫≠p D·ªØ li·ªáu (DCM).
           </li>
           <li>
            <strong>
             X√°c nh·∫≠n:
            </strong>
            Sai l·ªách c·ªßa c√°c th√¥ng s·ªë ch√≠nh (nh∆∞ c√¥ng su·∫•t, nhi·ªát ƒë·ªô kh√≠ x·∫£) ƒë∆∞·ª£c ki·ªÉm so√°t nghi√™m ng·∫∑t trong
            <strong>
             ph·∫°m vi sai s·ªë ¬±5%
            </strong>
            .
           </li>
          </ul>
         </div>
        </div>
       </div>
      </div>
      <div class="columns is-centered reveal" style="margin-top: 1rem; margin-bottom: 1rem;">
       <div class="column is-8 has-text-centered">
        <div style="height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
         <img alt="1-D thermodynamic simulation model" class="hover-card" src="../static/images/fig2_simulator.png" style="height: 100%; width: auto; max-width: 100%; object-fit: contain; border-radius: 8px;"/>
        </div>
        <p class="subtitle is-6">
         <strong>
          H√¨nh 2:
         </strong>
         S∆° ƒë·ªì m√¥ h√¨nh nhi·ªát ƒë·ªông l·ª±c h·ªçc m·ªôt chi·ªÅu c·ªßa ƒë·ªông c∆° diesel.
        </p>
       </div>
       <div class="column is-4 has-text-centered">
        <div style="height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
         <img alt="Model Validation Results" class="hover-card" src="../static/images/fig5_faults.jpg" style="height: 100%; width: auto; max-width: 100%; object-fit: contain; border-radius: 8px;"/>
        </div>
        <p class="subtitle is-6">
         <strong>
          H√¨nh 5:
         </strong>
         M√¥ ƒëun Thu th·∫≠p D·ªØ li·ªáu (DCM).
        </p>
       </div>
      </div>
      <div class="box hover-card reveal" style="margin-top: 1.5rem;">
       <h4 class="title is-4 is-size-5" style="display: flex; align-items: center; justify-content: center;">
        <span class="icon has-text-black" style="margin-right: 8px;">
         <i class="fas fa-cogs">
         </i>
        </span>
        <span>
         C∆° ch·∫ø ti√™m l·ªói
        </span>
       </h4>
       <div class="content has-text-justified is-size-6">
        <p>
         Do c√°c m√¥ h√¨nh m·ªôt chi·ªÅu kh√¥ng th·ªÉ bi·ªÉu di·ªÖn tr·ª±c ti·∫øp c√°c khi·∫øm khuy·∫øt c·∫•u tr√∫c 3D, ch√∫ng t√¥i ƒë√£ √°p d·ª•ng ph∆∞∆°ng ph√°p √°nh x·∫° hi·ªán t∆∞·ª£ng ƒë·ªÉ chuy·ªÉn ƒë·ªïi c√°c c∆° ch·∫ø suy gi·∫£m v·∫≠t l√Ω th√†nh c√°c d·ªãch chuy·ªÉn th√¥ng s·ªë nhi·ªát ƒë·ªông l·ª±c h·ªçc t∆∞∆°ng ƒë∆∞∆°ng.
        </p>
       </div>
       <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable is-size-6">
         <thead>
          <tr style="background-color: #f5f5f5;">
           <th style="width: 20%;">
            Lo·∫°i l·ªói
           </th>
           <th style="width: 35%;">
            C∆° ch·∫ø v·∫≠t l√Ω
           </th>
           <th>
            Tri·ªÉn khai m√¥ h√¨nh h√≥a
           </th>
          </tr>
         </thead>
         <tbody>
          <tr>
           <td>
            <strong>
             F1: N·ª©t n·∫Øp quy l√°t
            </strong>
           </td>
           <td>
            C·∫£n tr·ªü d·∫´n nhi·ªát.
           </td>
           <td>
            TƒÉng nhi·ªát ƒë·ªô b·ªÅ m·∫∑t n·∫Øp quy l√°t ($T_H$) l√™n 346¬∞C.
           </td>
          </tr>
          <tr>
           <td>
            <strong>
             F2: ƒÇn m√≤n piston
            </strong>
           </td>
           <td>
            M·∫•t v·∫≠t li·ªáu v√† h·ªèng l√†m k√≠n.
           </td>
           <td>
            TƒÉng nhi·ªát ƒë·ªô piston ($T_P$) + l·ªçt kh√≠ nh·∫π (blow-by) (0.01 kg/s).
           </td>
          </tr>
          <tr>
           <td>
            <strong>
             F3: M√≤n √°o xi-lanh
            </strong>
           </td>
           <td>
            TƒÉng ƒë∆∞·ªùng k√≠nh l√≤ng xy-lanh do m√†i m√≤n.
           </td>
           <td>
            TƒÉng ƒë∆∞·ªùng k√≠nh l√≤ng + l·ªçt kh√≠ nghi√™m tr·ªçng (0.03 kg/s).
           </td>
          </tr>
          <tr>
           <td>
            <strong>
             F4: M√≤n x√©c-mƒÉng
            </strong>
           </td>
           <td>
            R√≤ r·ªâ kh√≠.
           </td>
           <td>
            ƒêi·ªÅu ch·ªânh l∆∞u l∆∞·ª£ng kh·ªëi l∆∞·ª£ng l·ªçt kh√≠ (0.02 kg/s).
           </td>
          </tr>
          <tr>
           <td>
            <strong>
             F5: B√≥ k·∫πt x√©c-mƒÉng
            </strong>
           </td>
           <td>
            TƒÉng ma s√°t v√† h·ªèng l√†m k√≠n.
           </td>
           <td>
            Thay ƒë·ªïi ƒë∆∞·ªùng k√≠nh l√≤ng + tƒÉng nhi·ªát ƒë·ªô √°o xi-lanh + l·ªçt kh√≠.
           </td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </div>
    <hr/>
    <div class="columns is-centered">
     <div class="column is-full-width">
      <h2 class="title is-3 reveal">
       Ph√¢n t√≠ch kh·∫£ nƒÉng gi·∫£i th√≠ch
      </h2>
      <div class="content has-text-justified reveal delay-1">
       <p>
        M·ªôt s·ª± ƒë·ªïi m·ªõi c·ªët l√µi c·ªßa nghi√™n c·ª©u n√†y n·∫±m ·ªü vi·ªác chuy·ªÉn tr·ªçng t√¢m t·ª´ "L·ªói l√† g√¨?" sang "T·∫°i sao l·∫°i ch·∫©n ƒëo√°n l√† l·ªói ƒë√≥?". Ch√∫ng t√¥i ƒë√£ ch·ª©ng minh kh·∫£ nƒÉng n√†y th√¥ng qua ph√¢n t√≠ch l·ªói m√≤n x√©c-mƒÉng piston (F4):
       </p>
       <ul>
        <li>
         <strong>
          Gi·∫£i th√≠ch c·ª•c b·ªô (Bi·ªÉu ƒë·ªì th√°c n∆∞·ªõc):
         </strong>
         Bi·ªÉu ƒë·ªì th√°c n∆∞·ªõc ph√¢n t√≠ch logic d·ª± ƒëo√°n c·ª• th·ªÉ. V√≠ d·ª•, m√¥ h√¨nh d·ª± ƒëo√°n "m√≤n x√©c-mƒÉng" b·ªüi v√¨ d√≤ng nhi·ªát l·ªçt kh√≠ (P06) v√† l∆∞u l∆∞·ª£ng kh·ªëi l∆∞·ª£ng l·ªçt kh√≠ (P07) th·ªÉ hi·ªán c√°c gi√° tr·ªã c·ª• th·ªÉ, t·ª´ ƒë√≥ l√†m tƒÉng x√°c su·∫•t d·ª± ƒëo√°n l·ªói n√†y. ƒêi·ªÅu n√†y ph√π h·ª£p v·ªõi c√°c ƒë·ªãnh lu·∫≠t v·∫≠t l√Ω: x√©c-mƒÉng b·ªã m√≤n ph√° h·ªßy ƒë·ªô k√≠n, d·∫´n ƒë·∫øn r√≤ r·ªâ kh√≠ (l·ªçt kh√≠).
        </li>
        <li>
         <strong>
          Gi·∫£i th√≠ch to√†n c·ª•c (Bi·ªÉu ƒë·ªì b·∫ßy ong):
         </strong>
         Ph√¢n t√≠ch to√†n c·ª•c ti·∫øt l·ªô c√°c quy lu·∫≠t chung m√† m√¥ h√¨nh ƒë√£ h·ªçc ƒë∆∞·ª£c. Ch√∫ng t√¥i ph√°t hi·ªán ra r·∫±ng √°p su·∫•t kh√≠ x·∫£ tr∆∞·ªõc tuabin (P11) th·∫•p l√† m·ªôt ch·ªâ b√°o m·∫°nh m·∫Ω cho s·ª± m√≤n x√©c-mƒÉng. V·ªÅ m·∫∑t v·∫≠t l√Ω, ƒëi·ªÅu n√†y l√† nh·∫•t qu√°n: x√©c-mƒÉng b·ªã m√≤n d·∫´n ƒë·∫øn r√≤ r·ªâ kh√≠ t·ª´ xi-lanh, do ƒë√≥ l√†m gi·∫£m nƒÉng l∆∞·ª£ng s·∫µn c√≥ ƒë·ªÉ d·∫´n ƒë·ªông tuabin.
        </li>
       </ul>
      </div>
      <div class="has-text-centered reveal delay-2">
       <img alt="SHAP Analysis,including Waterfall plot, beeswarm plot, interaction plot and dependence plot" class="hover-card" src="../static/images/fig11_shap.jpg" style="width:100%; border-radius: 10px;"/>
       <p class="subtitle is-6">
        <strong>
         H√¨nh 11:
        </strong>
        Ph√¢n t√≠ch l·ªói m√≤n x√©c-mƒÉng (F4) d·ª±a tr√™n gi√° tr·ªã SHAP: (a) Bi·ªÉu ƒë·ªì th√°c n∆∞·ªõc; (b) Bi·ªÉu ƒë·ªì b·∫ßy ong; (c) Bi·ªÉu ƒë·ªì t∆∞∆°ng t√°c; (d) Bi·ªÉu ƒë·ªì ph·ª• thu·ªôc.
       </p>
      </div>
      <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/xcode.min.css" rel="stylesheet"/>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js">
      </script>
      <script>
       hljs.highlightAll();
      </script>
      <div class="reveal delay-2" style="margin-top: 2rem; margin-bottom: 2rem;">
       <details class="box hover-card" style="background-color: #fcfcfc; border: 1px solid #eee;">
        <summary class="title is-5 is-size-6-mobile" style="cursor: pointer; color: #363636; margin-bottom: 0;">
         <span class="icon has-text-info" style="margin-right: 0.5rem;">
          <i class="fas fa-code">
          </i>
         </span>
         <span>
          Xem m√£ tr·ª±c quan h√≥a SHAP (Python)
         </span>
        </summary>
        <div class="content has-text-left" style="margin-top: 1.5rem;">
         <p>
          <p>
           N·∫øu b·∫°n quan t√¢m ƒë·∫øn chi ti·∫øt tri·ªÉn khai c·ªßa c√°c bi·ªÉu ƒë·ªì tr√™n, ƒë√¢y l√† m√£ v√≠ d·ª• ƒë·ªÉ t·∫°o bi·ªÉu ƒë·ªì th√°c n∆∞·ªõc, b·∫ßy ong, t∆∞∆°ng t√°c v√† ph·ª• thu·ªôc.üëá
          </p>
         </p>
         <pre style="padding: 0; border-radius: 8px; overflow: hidden;"><code class="language-python" style="border-radius: 8px; font-size: 0.85rem; line-height: 1.5;">import shap
import matplotlib.pyplot as plt
import numpy as np

# --- 0. Setup &amp; Global Settings ---
plt.rcParams['font.family'] = 'Arial'
plt.rcParams['font.size'] = '24'
plt.rcParams['axes.unicode_minus'] = False

# Assumption: 'best_model' is your trained XGBoost/RF model
# Assumption: 'X_train' and 'X_test' are pandas DataFrames

# 1. Calculate SHAP values as Numpy Arrays (for Beeswarm, Dependence, Interaction)
explainer_tree = shap.TreeExplainer(best_model)
shap_values_numpy = explainer_tree.shap_values(X_train)

# 2. Calculate SHAP values as Explanation Object (Specifically for Waterfall)
explainer_obj = shap.Explainer(best_model, X_test)
shap_values_obj = explainer_obj(X_test)


##################################################################
#                                                                #
#                      (a) Waterfall Plot                        #
#          Visualizes contribution for a single sample           #
#                                                                #
##################################################################

class_idx = 4  # Target class
sample_idx = 3 # Specific sample to explain

plt.figure()
shap.plots.waterfall(
    shap_values_obj[sample_idx, :, class_idx],
    max_display=9,
    show=False
)

# Customizing style
ax = plt.gca()
ax.set_xlabel(ax.get_xlabel(), fontsize=36)
ax.set_ylabel(ax.get_ylabel(), fontsize=36)
ax.spines['bottom'].set_linewidth(3)
plt.show()


##################################################################
#                                                                #
#                      (b) Beeswarm Plot                         #
#              Global summary of feature importance              #
#                                                                #
##################################################################

class_idx = 5
plt.figure(figsize=(10, 8))

shap.summary_plot(
    shap_values_numpy[..., class_idx],
    X_train,
    feature_names=X_train.columns,
    plot_type="dot",
    show=False,
    cmap='Greys' # or 'plasma'
)

# Customize Color Bar
cbar = plt.gcf().axes[-1]
cbar.set_ylabel('Parameter Value', fontsize=24)
cbar.tick_params(labelsize=20)
plt.show()


##################################################################
#                                                                #
#                     (c) Interaction Plot                       #
#          Visualizes interaction effects between features       #
#                                                                #
##################################################################

# Note: Calculation can be expensive
shap_interaction_values = explainer_tree.shap_interaction_values(X_test)
class_idx = 4

plt.figure()
shap.summary_plot(
    shap_interaction_values[..., class_idx],
    X_test,
    show=False,
    max_display=6,
    cmap='Greys'
)

# Clean up subplots
axes = plt.gcf().axes
for ax in axes:
    ax.spines['bottom'].set_linewidth(2)
    ax.tick_params(axis="x", labelsize=18, width=2)
    ax.set_title(ax.get_title(), fontsize=14)

plt.subplots_adjust(wspace=0.3, hspace=0.4)
plt.show()


##################################################################
#                                                                #
#                     (d) Dependence Plot                        #
#           Feature relationship colored by interaction          #
#                                                                #
##################################################################

Feature_X = 'P06'  # Main feature
Feature_Y = 'P07'  # Interaction feature
class_idx = 4

shap.dependence_plot(
    Feature_X,
    shap_values_numpy[..., class_idx],
    X_train,
    interaction_index=Feature_Y,
    dot_size=100,
    show=False
)

# Customize Axes
ax = plt.gca()
ax.tick_params(axis='both', which='major', labelsize=36, width=2)
ax.set_ylabel(f'SHAP value ({Feature_X})', fontsize=36)
ax.spines['bottom'].set_linewidth(3)
ax.spines['left'].set_linewidth(3)
plt.show()


##################################################################
#                                                                #
#            (e) Advanced Composite Plot (Beeswarm + Bar)        #
#      Combines Beeswarm (Bottom Axis) &amp; Importance (Top Axis)   #
#                                                                #
##################################################################

class_idx = 5
fig, ax1 = plt.subplots(figsize=(10, 8))

# 1. Main Beeswarm Plot (on ax1)
shap.summary_plot(
    shap_values_numpy[..., class_idx],
    X_train,
    feature_names=X_train.columns,
    plot_type="dot",
    show=False,
    color_bar=True,
    cmap='Greys' # or 'plasma'
)

# Customize Color Bar
cbar = plt.gcf().axes[-1]
cbar.set_ylabel('Parameter Value', fontsize=24)
cbar.tick_params(labelsize=20)

# Adjust layout to make room for the top axis
plt.gca().set_position([0.2, 0.2, 0.65, 0.65])

# 2. Feature Importance Bar Plot (on Top Axis ax2)
# Create a twin axis sharing the y-axis
ax2 = ax1.twiny()

shap.summary_plot(
    shap_values_numpy[..., class_idx],
    X_train,
    plot_type="bar",
    show=False
)

# Align position with the main plot
plt.gca().set_position([0.2, 0.2, 0.65, 0.65])

# Style the bars (Transparent &amp; Light Color)
bars = ax2.patches
for bar in bars:
    bar.set_color('#CCE5FB') # Light blue background bars
    bar.set_alpha(0.4)       # Transparency

# Customize Axes Labels
ax1.set_xlabel(f'Shapley Value Contribution (F{class_idx})', fontsize=24, labelpad=5)
ax1.set_ylabel('Parameters', fontsize=24)
ax2.set_xlabel('Mean Shapley Value (Parameter Importance)', fontsize=24, labelpad=10)

# Move ax2 (Bar plot axis) to the top
ax2.xaxis.set_label_position('top')
ax2.xaxis.tick_top()

# Ensure ax1 (dots) is drawn ON TOP OF ax2 (bars)
ax1.set_zorder(ax1.get_zorder() + 1)
ax1.patch.set_visible(False) # Make ax1 background transparent

plt.show()</code></pre>
        </div>
       </details>
      </div>
     </div>
    </div>
    <hr/>
    <div class="columns is-centered">
     <div class="column is-full-width">
      <h2 class="title is-3 reveal">
       ƒêi·ªÉm n·ªïi b·∫≠t c·ªßa nghi√™n c·ª©u
      </h2>
      <div class="content has-text-justified reveal delay-1">
       <p>
        <p>
         Ch√∫ng t√¥i tin r·∫±ng c√¥ng tr√¨nh n√†y ƒë√£ ƒë√≥ng g√≥p nh·ªØng ƒëi·ªÉm ch√≠nh sau cho lƒ©nh v·ª±c n√†y:
        </p>
       </p>
       <ul class="highlight-list stagger-wrapper">
        <li class="stagger-item hover-card">
         <strong>
          Thi·∫øt l·∫≠p c√°c m√¥ h√¨nh tham s·ªë h√≥a cho nƒÉm l·ªói ƒëi·ªÉn h√¨nh c·ªßa c√°c b·ªô ph·∫≠n bu·ªìng ƒë·ªët ƒë·ªông c∆° diesel h√†ng h·∫£i.
         </strong>
        </li>
        <li class="stagger-item hover-card">
         <strong>
          X√°c nh·∫≠n t√≠nh hi·ªáu qu·∫£ c·ªßa ph∆∞∆°ng ph√°p SHAP th√¥ng qua so s√°nh v·ªõi nhi·ªÅu ph∆∞∆°ng ph√°p l·ª±a ch·ªçn ƒë·∫∑c tr∆∞ng kh√°c.
         </strong>
        </li>
        <li class="stagger-item hover-card">
         <strong>
          Cung c·∫•p m·ªôt g√≥c nh√¨n m·ªõi cho ch·∫©n ƒëo√°n l·ªói c√≥ th·ªÉ gi·∫£i th√≠ch ƒë∆∞·ª£c b·∫±ng c√°ch k·∫øt h·ª£p c√°c ph∆∞∆°ng ph√°p d·ª±a tr√™n d·ªØ li·ªáu v·ªõi c√°c m√¥ h√¨nh c∆° ch·∫ø nhi·ªát ƒë·ªông l·ª±c h·ªçc.
         </strong>
        </li>
       </ul>
      </div>
     </div>
    </div>
   </div>
  </section>
  <section class="section reveal" id="BibTeX" style="padding-top: 0; margin-top: -2rem;">
   <div class="container is-max-desktop content">
    <hr/>
    <h2 class="title">
     Tr√≠ch d·∫´n
    </h2>
    <div class="citation-prompt">
     <span class="icon is-small" style="margin-right: 0.5rem; color: #3273dc;">
      <i class="fas fa-quote-left">
      </i>
     </span>
     N·∫øu b·∫°n th·∫•y c√¥ng tr√¨nh n√†y h·ªØu √≠ch cho nghi√™n c·ª©u c·ªßa m√¨nh, vui l√≤ng xem x√©t tr√≠ch d·∫´n üòä
    </div>
    <h4 class="title is-5 is-size-6-mobile" style="margin-bottom: 0.5rem; color: #666;">
     BibTeX
    </h4>
    <pre style="margin-bottom: 5px; background-color: #fcfcfc; border: 1px solid #e5e5e5; border-radius: 8px; padding: 1.25rem;"><code class="language-latex" id="bibtex-source" style="font-family: 'Times New Roman', Times, serif !important; font-size: 16px; line-height: 1.5;">@article{luo2025thermodynamic,
  title     = {Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines},
  author    = {Luo, Congcong and Zhao, Minghang and Fu, Xuyun and Zhong, Shisheng and Fu, Song and Zhang, Kai and Yu, Xiaoxia},
  journal   = {Measurement},
  volume    = {251},
  pages     = {117252},
  year      = {2025},
  publisher = {Elsevier},
  doi       = {10.1016/j.measurement.2025.117252},
}</code></pre>
    <div class="level is-mobile" style="margin-top: 10px; margin-bottom: 2rem;">
     <div class="level-left">
      <button class="button is-dark is-small is-rounded" onclick="copyText('bibtex-source', this)">
       <span class="icon is-small">
        <i class="fas fa-copy">
        </i>
       </span>
       <span class="btn-text">
        Sao ch√©p BibTeX
       </span>
      </button>
     </div>
    </div>
    <h4 class="title is-5 is-size-6-mobile" style="margin-bottom: 0.5rem; color: #666;">
     ƒê·ªãnh d·∫°ng chu·∫©n
    </h4>
    <div class="box" style="background-color: #fcfcfc; border: 1px solid #e5e5e5; padding: 1.25rem; margin-bottom: 5px;">
     <p id="standard-citation" style="margin-bottom: 0; font-family: 'Times New Roman', Times, serif; font-size: 16px; line-height: 1.5;">
      C. Luo, M. Zhao, X. Fu, S. Zhong, S. Fu, K. Zhang, X. Yu. Thermodynamic simulation-assisted random forest: Towards explainable fault diagnosis of combustion chamber components of marine diesel engines[J]. Measurement, 2025, 251: 117252.
     </p>
    </div>
    <div class="level is-mobile" style="margin-top: 10px;">
     <div class="level-left">
      <button class="button is-dark is-small is-rounded" onclick="copyText('standard-citation', this)">
       <span class="icon is-small">
        <i class="fas fa-copy">
        </i>
       </span>
       <span class="btn-text">
        Sao ch√©p vƒÉn b·∫£n
       </span>
      </button>
      <a class="button is-text is-small" href="https://www.sciencedirect.com/science/article/pii/S0263224125006116" style="text-decoration: none; margin-left: 10px;" target="_blank">
       <span class="icon has-text-info">
        <i class="fas fa-external-link-alt">
        </i>
       </span>
       <span>
        Xem tr√™n ScienceDirect
       </span>
      </a>
     </div>
    </div>
   </div>
  </section>
  <style>
   .citation-prompt {
    background-color: #f5f5f5;
    border-left: 5px solid #3273dc;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    border-radius: 4px;
    font-size: 1.1rem;
    color: #4a4a4a;
    font-weight: 500;
  }
  /* Á°Æ‰øù pre Ê†áÁ≠æ‰∏ç‰ºöÂõ†‰∏∫Ê°ÜÊû∂Ê†∑ÂºèÂπ≤Êâ∞ padding */
  pre {
      padding: 1.25rem !important;
  }
  </style>
  <script>
   function copyText(elementId, btn) {
    const textToCopy = document.getElementById(elementId).innerText;
    navigator.clipboard.writeText(textToCopy).then(() => {
      const icon = btn.querySelector('.fa-copy');
      const text = btn.querySelector('.btn-text');
      const originalText = text.innerText;

      if(icon) {
        icon.classList.remove('fa-copy');
        icon.classList.add('fa-check');
      }
      if(text) text.innerText = "Copied!";

      btn.classList.remove('is-dark');
      btn.classList.add('is-success');

      setTimeout(() => {
        if(icon) {
          icon.classList.remove('fa-check');
          icon.classList.add('fa-copy');
        }
        if(text) text.innerText = originalText;
        btn.classList.remove('is-success');
        btn.classList.add('is-dark');
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }
  </script>
  <footer class="footer">
   <div class="container">
    <div class="content has-text-centered">
     <a class="icon-link" href="https://doi.org/10.1016/j.measurement.2025.117252">
      <i class="fas fa-file-pdf">
      </i>
     </a>
     <a class="external-link" disabled="" href="#">
      <i class="fab fa-github">
      </i>
     </a>
    </div>
    <div class="columns is-centered is-vcentered">
     <div class="column is-6">
      <div class="content">
       <p>
        This website is licensed under a
        <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license">
         Creative
            Commons Attribution-ShareAlike 4.0 International License
        </a>
        .
       </p>
       <p>
        Copyright ¬© 2025 Congcong Luo et al. Published in
        <a href="https://doi.org/10.1016/j.measurement.2025.117252" target="_blank">
         Measurement
        </a>
        .
       </p>
       <p>
        This website is adapted from the
        <a href="https://github.com/nerfies/nerfies.github.io">
         Nerfies
        </a>
        project page template.
       </p>
       <p style="margin-top: 10px; font-size: 0.9rem;">
        <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
        </script>
        <span id="busuanzi_container_site_uv" style="display:none">
         Kh√°ch truy c·∫≠p:
         <span id="busuanzi_value_site_uv" style="font-weight: bold;">
         </span>
        </span>
        <span style="margin: 0 8px; color: #ccc;">
         |
        </span>
        <span id="busuanzi_container_site_pv" style="display:none">
         T·ªïng l∆∞·ª£t truy c·∫≠p:
         <span id="busuanzi_value_site_pv" style="font-weight: bold;">
         </span>
        </span>
       </p>
      </div>
     </div>
     <div class="column is-2">
      <div style="width: 100%; max-width: 200px; margin: 0 auto 0 0;">
       <script id="clstr_globe" src="//clustrmaps.com/globe.js?d=_zkZv1bfxiqAq8HXllAuUZNIvCYv603-zyA7z-Vpjfw" type="text/javascript">
       </script>
      </div>
     </div>
    </div>
   </div>
  </footer>
  <script>
   document.addEventListener('DOMContentLoaded', () => {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');

            }
        });
    }, {
        threshold: 0.1
    });

    // ÁõëÂê¨ reveal Á±ªÂíå stagger-wrapper Á±ª
    document.querySelectorAll('.reveal, .stagger-wrapper').forEach(el => {
        observer.observe(el);
    });
});
  </script>
 </body>
</html>
